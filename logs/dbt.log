

============================== 2022-12-20 17:58:24.431805 | 154e78c6-843a-49f3-a7c8-41dd5d829736 ==============================
[0m17:58:24.431816 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:58:24.432148 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:58:24.432291 [debug] [MainThread]: Tracking: tracking
[0m17:58:24.449271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0634c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a062f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a062c80>]}
[0m17:58:24.862775 [debug] [MainThread]: Executing "git --help"
[0m17:58:24.881196 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:58:24.882158 [debug] [MainThread]: STDERR: "b''"
[0m17:58:24.888243 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m17:58:24.889702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:24.892624 [debug] [MainThread]: On debug: select 1 as id
[0m17:58:25.927125 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:39adb6f4-5146-40d8-88f6-1c9035133808:US&page=queryresults
[0m17:58:25.927836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c138400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c13aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c13a140>]}
[0m17:58:25.928311 [debug] [MainThread]: Flushing usage events
[0m17:58:26.088122 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-20 18:01:44.855716 | 7eaa2ef5-fd3a-4937-8370-32e94a0f7ec5 ==============================
[0m18:01:44.855749 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:01:44.856290 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:01:44.856416 [debug] [MainThread]: Tracking: tracking
[0m18:01:44.874397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6cf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6cd4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6cd090>]}
[0m18:01:44.890739 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m18:01:44.891076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7eaa2ef5-fd3a-4937-8370-32e94a0f7ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6e1090>]}
[0m18:01:44.943434 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:01:44.946172 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:01:44.953039 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:01:44.976567 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:01:44.979382 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:01:44.982305 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:01:44.988736 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:01:44.991027 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:01:45.006295 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:01:45.007716 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:01:45.008052 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:01:45.008592 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m18:01:45.009534 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:01:45.009869 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:01:45.010357 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:01:45.010905 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:01:45.011735 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:01:45.012754 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:01:45.013208 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:01:45.013648 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:01:45.014122 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:01:45.014624 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:01:45.015016 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:01:45.016226 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:01:45.016688 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:01:45.017383 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:01:45.017897 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:01:45.020056 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:01:45.023291 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:01:45.025225 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:01:45.026603 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:01:45.040140 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:01:45.051331 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:01:45.061449 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:01:45.065198 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:01:45.066673 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:01:45.068178 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:01:45.074961 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:01:45.087901 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:01:45.089118 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:01:45.094894 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:01:45.103467 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:01:45.138734 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:01:45.144839 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:01:45.148657 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:01:45.154403 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:01:45.155774 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:01:45.159187 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:01:45.161363 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:01:45.167295 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:01:45.183029 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:01:45.184291 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:01:45.186278 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:01:45.187574 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:01:45.188287 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:01:45.188984 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:01:45.189543 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:01:45.190639 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:01:45.194977 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:01:45.201798 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:01:45.202497 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:01:45.203505 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:01:45.204320 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:01:45.205118 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:01:45.206153 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:01:45.206853 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:01:45.207739 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:01:45.208758 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:01:45.210813 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:01:45.212080 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:01:45.232920 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:01:45.234543 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:01:45.236041 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:01:45.237150 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:01:45.238447 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:01:45.239539 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:01:45.247648 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:01:45.248970 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:01:45.250060 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:01:45.252120 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:01:45.254570 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:01:45.255754 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:01:45.257462 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:01:45.258639 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:01:45.260969 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:01:45.264606 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:01:45.267552 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:01:45.281659 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:01:45.283287 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:01:45.294737 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:01:45.298373 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:01:45.304352 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:01:45.312435 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:01:45.317416 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:01:45.636631 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m18:01:45.649710 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m18:01:45.712384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eaa2ef5-fd3a-4937-8370-32e94a0f7ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a09a0>]}
[0m18:01:45.718599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eaa2ef5-fd3a-4937-8370-32e94a0f7ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d805480>]}
[0m18:01:45.718824 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:01:45.719007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eaa2ef5-fd3a-4937-8370-32e94a0f7ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6cd570>]}
[0m18:01:45.719973 [info ] [MainThread]: 
[0m18:01:45.720414 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:01:45.721120 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m18:01:45.721315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:46.285207 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m18:01:46.285592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:46.710341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eaa2ef5-fd3a-4937-8370-32e94a0f7ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7246a0>]}
[0m18:01:46.711199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:46.711519 [info ] [MainThread]: 
[0m18:01:46.717297 [debug] [Thread-1 (]: Began running node model.formula1.my_first_dbt_model
[0m18:01:46.717669 [info ] [Thread-1 (]: 1 of 2 START sql table model formula1.my_first_dbt_model ....................... [RUN]
[0m18:01:46.718408 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.my_first_dbt_model"
[0m18:01:46.718607 [debug] [Thread-1 (]: Began compiling node model.formula1.my_first_dbt_model
[0m18:01:46.718767 [debug] [Thread-1 (]: Compiling model.formula1.my_first_dbt_model
[0m18:01:46.722134 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.my_first_dbt_model"
[0m18:01:46.723023 [debug] [Thread-1 (]: finished collecting timing info
[0m18:01:46.723224 [debug] [Thread-1 (]: Began executing node model.formula1.my_first_dbt_model
[0m18:01:46.773258 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.my_first_dbt_model"
[0m18:01:46.774201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:46.775559 [debug] [Thread-1 (]: On model.formula1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.my_first_dbt_model"} */

  
    

    create or replace table `armin-playground`.`formula1`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:01:47.213995 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.my_first_dbt_model"} */

  
    

    create or replace table `armin-playground`.`formula1`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:01:47.214347 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset armin-playground:formula1 was not found in location US

Location: US
Job ID: a41ffc3d-88c9-4c76-8de7-7b1680b2f2f7

[0m18:01:47.214707 [debug] [Thread-1 (]: finished collecting timing info
[0m18:01:47.215342 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  404 Not found: Dataset armin-playground:formula1 was not found in location US
  
  Location: US
  Job ID: a41ffc3d-88c9-4c76-8de7-7b1680b2f2f7
  
[0m18:01:47.215691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eaa2ef5-fd3a-4937-8370-32e94a0f7ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9ce650>]}
[0m18:01:47.216115 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model formula1.my_first_dbt_model .............. [[31mERROR[0m in 0.50s]
[0m18:01:47.216824 [debug] [Thread-1 (]: Finished running node model.formula1.my_first_dbt_model
[0m18:01:47.217499 [debug] [Thread-1 (]: Began running node model.formula1.my_second_dbt_model
[0m18:01:47.217789 [info ] [Thread-1 (]: 2 of 2 SKIP relation formula1.my_second_dbt_model .............................. [[33mSKIP[0m]
[0m18:01:47.218235 [debug] [Thread-1 (]: Finished running node model.formula1.my_second_dbt_model
[0m18:01:47.219293 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:01:47.219828 [info ] [MainThread]: 
[0m18:01:47.220079 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m18:01:47.220309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:47.220436 [debug] [MainThread]: Connection 'model.formula1.my_first_dbt_model' was properly closed.
[0m18:01:47.228479 [info ] [MainThread]: 
[0m18:01:47.228790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:47.229067 [info ] [MainThread]: 
[0m18:01:47.229304 [error] [MainThread]: [33mRuntime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)[0m
[0m18:01:47.229596 [error] [MainThread]:   404 Not found: Dataset armin-playground:formula1 was not found in location US
[0m18:01:47.229819 [error] [MainThread]:   
[0m18:01:47.230018 [error] [MainThread]:   Location: US
[0m18:01:47.230212 [error] [MainThread]:   Job ID: a41ffc3d-88c9-4c76-8de7-7b1680b2f2f7
[0m18:01:47.230401 [error] [MainThread]:   
[0m18:01:47.230605 [info ] [MainThread]: 
[0m18:01:47.230810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m18:01:47.231101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109472d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9ce320>]}
[0m18:01:47.231346 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 18:08:51.103810 | 8461cb47-c7c6-405d-9d54-a958bf5c8ddb ==============================
[0m18:08:51.103821 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:08:51.104141 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m18:08:51.104294 [debug] [MainThread]: Tracking: tracking
[0m18:08:51.122421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbb7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbb6fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbb6ce0>]}
[0m18:08:51.575906 [debug] [MainThread]: Executing "git --help"
[0m18:08:51.596587 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:08:51.597976 [debug] [MainThread]: STDERR: "b''"
[0m18:08:51.605176 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m18:08:51.606593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:51.609632 [debug] [MainThread]: On debug: select 1 as id
[0m18:08:52.767061 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:b11ee3e9-eefe-4fb1-bd16-c37533b8d9b8:US&page=queryresults
[0m18:08:52.767718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e2d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dc4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dc6860>]}
[0m18:08:52.768139 [debug] [MainThread]: Flushing usage events
[0m18:08:52.954159 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-20 18:10:44.160009 | 454a5810-238a-4f2d-a9d3-371a0281d020 ==============================
[0m18:10:44.160022 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:10:44.160332 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m18:10:44.160476 [debug] [MainThread]: Tracking: tracking
[0m18:10:44.183800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b6f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b6ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b6ec80>]}
[0m18:10:44.627736 [debug] [MainThread]: Executing "git --help"
[0m18:10:44.650709 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:10:44.651733 [debug] [MainThread]: STDERR: "b''"
[0m18:10:44.658824 [debug] [MainThread]: Acquiring new bigquery connection "debug"
[0m18:10:44.660144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:44.663606 [debug] [MainThread]: On debug: select 1 as id
[0m18:10:45.825554 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:f34e208f-2fde-4e28-8322-bdb83e15208b:US&page=queryresults
[0m18:10:45.826200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e6ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c44970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c46a70>]}
[0m18:10:45.826634 [debug] [MainThread]: Flushing usage events
[0m18:10:46.018835 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-20 18:16:53.487701 | ddf8329b-502f-4523-b27e-86ade36db384 ==============================
[0m18:16:53.487835 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:16:53.488844 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:16:53.489013 [debug] [MainThread]: Tracking: tracking
[0m18:16:53.514138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc9720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eccb310>]}
[0m18:16:53.560871 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:16:53.561261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddf8329b-502f-4523-b27e-86ade36db384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae92530>]}
[0m18:16:53.609294 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:16:53.611764 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:16:53.618177 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:16:53.637323 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:16:53.639512 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:16:53.641959 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:16:53.648650 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:16:53.651045 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:16:53.666593 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:16:53.668048 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:16:53.668404 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:16:53.668966 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m18:16:53.669939 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:16:53.670290 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:16:53.670804 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:16:53.671429 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:16:53.672360 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:16:53.673431 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:16:53.673906 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:16:53.674369 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:16:53.674857 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:16:53.675328 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:16:53.675737 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:16:53.676980 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:16:53.677467 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:16:53.678174 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:16:53.678685 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:16:53.680848 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:16:53.684225 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:16:53.686193 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:16:53.687633 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:16:53.701152 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:16:53.711890 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:16:53.721617 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:16:53.725528 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:16:53.726970 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:16:53.728445 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:16:53.735591 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:16:53.748635 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:16:53.749864 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:16:53.755679 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:16:53.764854 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:16:53.778958 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:16:53.783757 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:16:53.786689 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:16:53.791164 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:16:53.792248 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:16:53.795060 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:16:53.796969 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:16:53.802714 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:16:53.817998 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:16:53.819223 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:16:53.821252 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:16:53.822558 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:16:53.823288 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:16:53.823963 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:16:53.824537 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:16:53.825652 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:16:53.830313 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:16:53.837260 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:16:53.838029 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:16:53.839071 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:16:53.839904 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:16:53.840710 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:16:53.841751 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:16:53.842457 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:16:53.843360 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:16:53.844396 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:16:53.846279 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:16:53.847321 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:16:53.848243 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:16:53.849153 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:16:53.850051 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:16:53.850846 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:16:53.851766 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:16:53.852557 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:16:53.858213 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:16:53.859111 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:16:53.859909 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:16:53.861442 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:16:53.863265 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:16:53.864157 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:16:53.865415 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:16:53.866321 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:16:53.868126 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:16:53.871011 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:16:53.873441 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:16:53.886029 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:16:53.887634 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:16:53.898947 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:16:53.902520 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:16:53.908670 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:16:53.916961 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:16:53.922055 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:16:54.246113 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m18:16:54.257081 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m18:16:54.318002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddf8329b-502f-4523-b27e-86ade36db384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee59090>]}
[0m18:16:54.324916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddf8329b-502f-4523-b27e-86ade36db384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecdb070>]}
[0m18:16:54.325217 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:16:54.325440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf8329b-502f-4523-b27e-86ade36db384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae90820>]}
[0m18:16:54.326521 [info ] [MainThread]: 
[0m18:16:54.327066 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:16:54.327934 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m18:16:54.328239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:54.863578 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m18:16:54.864037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:55.253834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf8329b-502f-4523-b27e-86ade36db384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd207c0>]}
[0m18:16:55.254537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:55.254829 [info ] [MainThread]: 
[0m18:16:55.259101 [debug] [Thread-1 (]: Began running node model.formula1.my_first_dbt_model
[0m18:16:55.259445 [info ] [Thread-1 (]: 1 of 2 START sql table model formula1.my_first_dbt_model ....................... [RUN]
[0m18:16:55.260123 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.my_first_dbt_model"
[0m18:16:55.260311 [debug] [Thread-1 (]: Began compiling node model.formula1.my_first_dbt_model
[0m18:16:55.260498 [debug] [Thread-1 (]: Compiling model.formula1.my_first_dbt_model
[0m18:16:55.263915 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.my_first_dbt_model"
[0m18:16:55.264474 [debug] [Thread-1 (]: finished collecting timing info
[0m18:16:55.264675 [debug] [Thread-1 (]: Began executing node model.formula1.my_first_dbt_model
[0m18:16:55.309304 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.my_first_dbt_model"
[0m18:16:55.309936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:55.311190 [debug] [Thread-1 (]: On model.formula1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.my_first_dbt_model"} */

  
    

    create or replace table `armin-playground`.`formula1`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:16:55.728245 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.my_first_dbt_model"} */

  
    

    create or replace table `armin-playground`.`formula1`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:16:55.728609 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset armin-playground:formula1 was not found in location US

Location: US
Job ID: 9433c69e-c14c-43f0-8320-704536e4d7c4

[0m18:16:55.728946 [debug] [Thread-1 (]: finished collecting timing info
[0m18:16:55.729622 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  404 Not found: Dataset armin-playground:formula1 was not found in location US
  
  Location: US
  Job ID: 9433c69e-c14c-43f0-8320-704536e4d7c4
  
[0m18:16:55.729941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf8329b-502f-4523-b27e-86ade36db384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef965c0>]}
[0m18:16:55.730390 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model formula1.my_first_dbt_model .............. [[31mERROR[0m in 0.47s]
[0m18:16:55.730943 [debug] [Thread-1 (]: Finished running node model.formula1.my_first_dbt_model
[0m18:16:55.731526 [debug] [Thread-1 (]: Began running node model.formula1.my_second_dbt_model
[0m18:16:55.731774 [info ] [Thread-1 (]: 2 of 2 SKIP relation formula1.my_second_dbt_model .............................. [[33mSKIP[0m]
[0m18:16:55.733113 [debug] [Thread-1 (]: Finished running node model.formula1.my_second_dbt_model
[0m18:16:55.739148 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:16:55.739738 [info ] [MainThread]: 
[0m18:16:55.740028 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m18:16:55.740288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:55.740433 [debug] [MainThread]: Connection 'model.formula1.my_first_dbt_model' was properly closed.
[0m18:16:55.751604 [info ] [MainThread]: 
[0m18:16:55.752035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:16:55.752339 [info ] [MainThread]: 
[0m18:16:55.752734 [error] [MainThread]: [33mRuntime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)[0m
[0m18:16:55.752984 [error] [MainThread]:   404 Not found: Dataset armin-playground:formula1 was not found in location US
[0m18:16:55.753212 [error] [MainThread]:   
[0m18:16:55.753432 [error] [MainThread]:   Location: US
[0m18:16:55.753650 [error] [MainThread]:   Job ID: 9433c69e-c14c-43f0-8320-704536e4d7c4
[0m18:16:55.753865 [error] [MainThread]:   
[0m18:16:55.754098 [info ] [MainThread]: 
[0m18:16:55.754332 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m18:16:55.754723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edcf4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edcf940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edcf580>]}
[0m18:16:55.755005 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 18:25:50.105683 | 5863e62c-8a18-4261-b2e6-85aef8207651 ==============================
[0m18:25:50.105726 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:25:50.106824 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:25:50.107028 [debug] [MainThread]: Tracking: tracking
[0m18:25:50.130530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee3f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee3d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee3ceb0>]}
[0m18:25:50.176659 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:25:50.177059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5863e62c-8a18-4261-b2e6-85aef8207651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b16be20>]}
[0m18:25:50.218533 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:25:50.220613 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:25:50.225845 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:25:50.244179 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:25:50.246290 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:25:50.248648 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:25:50.254971 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:25:50.257238 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:25:50.272256 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:25:50.273653 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:25:50.273996 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:25:50.274543 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m18:25:50.275480 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:25:50.275816 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:25:50.276318 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:25:50.276967 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:25:50.277817 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:25:50.278849 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:25:50.279312 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:25:50.279761 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:25:50.280244 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:25:50.280709 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:25:50.281119 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:25:50.282344 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:25:50.282813 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:25:50.283518 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:25:50.284048 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:25:50.286207 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:25:50.289423 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:25:50.291410 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:25:50.292787 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:25:50.306425 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:25:50.317333 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:25:50.327242 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:25:50.330948 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:25:50.332408 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:25:50.333916 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:25:50.340620 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:25:50.353695 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:25:50.354953 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:25:50.360855 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:25:50.369634 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:25:50.383733 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:25:50.388466 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:25:50.391311 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:25:50.395724 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:25:50.396787 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:25:50.399651 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:25:50.401568 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:25:50.407291 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:25:50.422404 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:25:50.423705 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:25:50.425753 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:25:50.427045 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:25:50.427830 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:25:50.428501 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:25:50.429075 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:25:50.430230 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:25:50.434764 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:25:50.441928 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:25:50.442631 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:25:50.443729 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:25:50.444556 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:25:50.445360 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:25:50.446395 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:25:50.447098 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:25:50.447975 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:25:50.448996 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:25:50.450955 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:25:50.452048 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:25:50.452966 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:25:50.453871 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:25:50.454760 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:25:50.455553 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:25:50.456467 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:25:50.457250 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:25:50.462822 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:25:50.463845 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:25:50.464640 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:25:50.466141 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:25:50.467945 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:25:50.468824 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:25:50.470151 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:25:50.471041 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:25:50.472887 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:25:50.475782 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:25:50.478639 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:25:50.491589 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:25:50.493281 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:25:50.504923 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:25:50.508587 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:25:50.514642 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:25:50.523250 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:25:50.528593 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:25:50.847889 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m18:25:50.860864 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m18:25:50.923279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5863e62c-8a18-4261-b2e6-85aef8207651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd77c0>]}
[0m18:25:50.929278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5863e62c-8a18-4261-b2e6-85aef8207651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd5ae0>]}
[0m18:25:50.929543 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:25:50.929833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5863e62c-8a18-4261-b2e6-85aef8207651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c689090>]}
[0m18:25:50.931115 [info ] [MainThread]: 
[0m18:25:50.931735 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:25:50.932613 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m18:25:50.932954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:51.548614 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m18:25:51.548949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:51.932727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5863e62c-8a18-4261-b2e6-85aef8207651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce9c880>]}
[0m18:25:51.933439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:51.933745 [info ] [MainThread]: 
[0m18:25:51.938627 [debug] [Thread-1 (]: Began running node model.formula1.my_first_dbt_model
[0m18:25:51.938981 [info ] [Thread-1 (]: 1 of 2 START sql table model formula1.my_first_dbt_model ....................... [RUN]
[0m18:25:51.939682 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.my_first_dbt_model"
[0m18:25:51.939870 [debug] [Thread-1 (]: Began compiling node model.formula1.my_first_dbt_model
[0m18:25:51.940050 [debug] [Thread-1 (]: Compiling model.formula1.my_first_dbt_model
[0m18:25:51.943194 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.my_first_dbt_model"
[0m18:25:51.943751 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:51.943969 [debug] [Thread-1 (]: Began executing node model.formula1.my_first_dbt_model
[0m18:25:51.989435 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.my_first_dbt_model"
[0m18:25:51.990130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:51.991678 [debug] [Thread-1 (]: On model.formula1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.my_first_dbt_model"} */

  
    

    create or replace table `armin-playground`.`formula1`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:25:54.427256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:02f01bd4-e861-424a-a32f-dac424ca809d:us-east4&page=queryresults
[0m18:25:54.444222 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:54.444853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5863e62c-8a18-4261-b2e6-85aef8207651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eebd990>]}
[0m18:25:54.445222 [info ] [Thread-1 (]: 1 of 2 OK created sql table model formula1.my_first_dbt_model .................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.51s]
[0m18:25:54.445672 [debug] [Thread-1 (]: Finished running node model.formula1.my_first_dbt_model
[0m18:25:54.446299 [debug] [Thread-1 (]: Began running node model.formula1.my_second_dbt_model
[0m18:25:54.446571 [info ] [Thread-1 (]: 2 of 2 START sql view model formula1.my_second_dbt_model ....................... [RUN]
[0m18:25:54.447189 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.my_second_dbt_model"
[0m18:25:54.447385 [debug] [Thread-1 (]: Began compiling node model.formula1.my_second_dbt_model
[0m18:25:54.447554 [debug] [Thread-1 (]: Compiling model.formula1.my_second_dbt_model
[0m18:25:54.454003 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.my_second_dbt_model"
[0m18:25:54.454626 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:54.454824 [debug] [Thread-1 (]: Began executing node model.formula1.my_second_dbt_model
[0m18:25:54.478737 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.my_second_dbt_model"
[0m18:25:54.479378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:54.480732 [debug] [Thread-1 (]: On model.formula1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.my_second_dbt_model"} */


  create or replace view `armin-playground`.`formula1`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `armin-playground`.`formula1`.`my_first_dbt_model`
where id = 1;


[0m18:25:55.186122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:78bd3ece-c914-47b8-8717-0280ef4e87e0:us-east4&page=queryresults
[0m18:25:55.187797 [debug] [Thread-1 (]: finished collecting timing info
[0m18:25:55.188404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5863e62c-8a18-4261-b2e6-85aef8207651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a2f20>]}
[0m18:25:55.188768 [info ] [Thread-1 (]: 2 of 2 OK created sql view model formula1.my_second_dbt_model .................. [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m18:25:55.189216 [debug] [Thread-1 (]: Finished running node model.formula1.my_second_dbt_model
[0m18:25:55.190362 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:25:55.190903 [info ] [MainThread]: 
[0m18:25:55.191193 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m18:25:55.191458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:55.191606 [debug] [MainThread]: Connection 'model.formula1.my_second_dbt_model' was properly closed.
[0m18:25:55.203393 [info ] [MainThread]: 
[0m18:25:55.203736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:55.204045 [info ] [MainThread]: 
[0m18:25:55.204291 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:25:55.204629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f01c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f10d5d0>]}
[0m18:25:55.204895 [debug] [MainThread]: Flushing usage events


============================== 2022-12-31 21:01:41.282611 | dbd20a1f-394a-4536-990b-6dc4d8a13719 ==============================
[0m21:01:41.282642 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:01:41.283828 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:01:41.284046 [debug] [MainThread]: Tracking: tracking
[0m21:01:41.311999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6200a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a620550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a622470>]}
[0m21:01:41.359113 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:01:41.359568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbd20a1f-394a-4536-990b-6dc4d8a13719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5f74c0>]}
[0m21:01:41.407384 [debug] [MainThread]: Parsing macros/etc.sql
[0m21:01:41.410368 [debug] [MainThread]: Parsing macros/catalog.sql
[0m21:01:41.417816 [debug] [MainThread]: Parsing macros/adapters.sql
[0m21:01:41.442190 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m21:01:41.444867 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m21:01:41.447963 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m21:01:41.455256 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m21:01:41.458011 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m21:01:41.474479 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m21:01:41.476028 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:01:41.476391 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:01:41.476957 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m21:01:41.478028 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:01:41.478466 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:01:41.479061 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:01:41.479647 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:01:41.480519 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:01:41.481586 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:01:41.482071 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:01:41.482545 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:01:41.483045 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m21:01:41.483527 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:01:41.483943 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:01:41.485191 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:01:41.485730 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m21:01:41.486692 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m21:01:41.487242 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:01:41.489712 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m21:01:41.493036 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m21:01:41.495357 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m21:01:41.496785 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m21:01:41.511520 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m21:01:41.523261 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m21:01:41.534365 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m21:01:41.538240 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m21:01:41.539935 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m21:01:41.541587 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m21:01:41.548578 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m21:01:41.563182 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m21:01:41.564529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m21:01:41.570810 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m21:01:41.581486 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m21:01:41.597452 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m21:01:41.602245 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m21:01:41.605565 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m21:01:41.610431 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m21:01:41.611564 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m21:01:41.614382 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m21:01:41.616351 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m21:01:41.622918 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m21:01:41.638891 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m21:01:41.640232 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m21:01:41.642347 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m21:01:41.643691 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m21:01:41.644452 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m21:01:41.645153 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m21:01:41.645757 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m21:01:41.646923 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m21:01:41.651481 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m21:01:41.658912 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:01:41.659816 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m21:01:41.660950 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m21:01:41.661827 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m21:01:41.662673 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:01:41.663784 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:01:41.664540 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:01:41.665483 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:01:41.666578 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:01:41.668606 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:01:41.669765 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:01:41.670832 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:01:41.671817 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m21:01:41.672834 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m21:01:41.673875 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:01:41.674846 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m21:01:41.675689 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m21:01:41.681656 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m21:01:41.682604 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:01:41.683533 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m21:01:41.685118 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:01:41.687021 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:01:41.687957 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m21:01:41.689395 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m21:01:41.690365 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m21:01:41.692252 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m21:01:41.695181 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m21:01:41.697618 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m21:01:41.710765 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m21:01:41.712463 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:01:41.724220 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m21:01:41.727937 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m21:01:41.734164 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m21:01:41.742761 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m21:01:41.748000 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m21:01:42.087657 [debug] [MainThread]: 1699: static parser successfully parsed example/first_place_results.sql
[0m21:01:42.123194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fd4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fce20>]}
[0m21:01:42.123484 [debug] [MainThread]: Flushing usage events
[0m21:01:42.359861 [error] [MainThread]: Encountered an error:
Compilation Error in model first_place_results (models/example/first_place_results.sql)
  Model 'model.formula1.first_place_results' (models/example/first_place_results.sql) depends on a source named 'formula1_src.results' which was not found


============================== 2022-12-31 21:02:30.601703 | fd223126-5329-48d2-abb7-97a21f1afd48 ==============================
[0m21:02:30.601729 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:02:30.602307 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:02:30.602457 [debug] [MainThread]: Tracking: tracking
[0m21:02:30.619629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d741c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d76c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d76590>]}
[0m21:02:30.661787 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:02:30.662173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd223126-5329-48d2-abb7-97a21f1afd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d4b1c0>]}
[0m21:02:30.689147 [debug] [MainThread]: Parsing macros/etc.sql
[0m21:02:30.691706 [debug] [MainThread]: Parsing macros/catalog.sql
[0m21:02:30.698412 [debug] [MainThread]: Parsing macros/adapters.sql
[0m21:02:30.720394 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m21:02:30.722781 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m21:02:30.725301 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m21:02:30.731745 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m21:02:30.734076 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m21:02:30.749621 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m21:02:30.751044 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:02:30.751398 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:02:30.751950 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m21:02:30.752908 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:02:30.753251 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:02:30.753753 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:02:30.754312 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:02:30.755167 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:02:30.756206 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:02:30.756673 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:02:30.757128 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:02:30.757616 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m21:02:30.758091 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:02:30.758499 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:02:30.759717 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:02:30.760198 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m21:02:30.760911 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m21:02:30.761442 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:02:30.763612 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m21:02:30.766855 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m21:02:30.768822 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m21:02:30.770219 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m21:02:30.783930 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m21:02:30.794784 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m21:02:30.804516 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m21:02:30.808189 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m21:02:30.809629 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m21:02:30.811115 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m21:02:30.817732 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m21:02:30.830514 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m21:02:30.831745 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m21:02:30.837434 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m21:02:30.846021 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m21:02:30.859828 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m21:02:30.864305 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m21:02:30.867203 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m21:02:30.871718 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m21:02:30.872800 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m21:02:30.875555 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m21:02:30.877462 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m21:02:30.884003 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m21:02:30.899175 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m21:02:30.900389 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m21:02:30.902372 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m21:02:30.903642 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m21:02:30.904357 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m21:02:30.905028 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m21:02:30.905597 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m21:02:30.906696 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m21:02:30.910979 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m21:02:30.918164 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:02:30.918860 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m21:02:30.919867 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m21:02:30.920679 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m21:02:30.921468 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:02:30.922489 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:02:30.923186 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:02:30.924063 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:02:30.925083 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:02:30.926932 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:02:30.927958 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:02:30.928864 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:02:30.929761 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m21:02:30.930635 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m21:02:30.931419 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:02:30.932313 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m21:02:30.933082 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m21:02:30.938633 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m21:02:30.939510 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:02:30.940411 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m21:02:30.941888 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:02:30.943669 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:02:30.944540 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m21:02:30.945765 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m21:02:30.946648 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m21:02:30.948396 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m21:02:30.951147 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m21:02:30.953433 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m21:02:30.965382 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m21:02:30.966979 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:02:30.978090 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m21:02:30.981698 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m21:02:30.987550 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m21:02:30.995429 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m21:02:31.000120 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m21:02:31.306184 [debug] [MainThread]: 1699: static parser successfully parsed example/first_place_results.sql
[0m21:02:31.368784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd223126-5329-48d2-abb7-97a21f1afd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f30850>]}
[0m21:02:31.376910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd223126-5329-48d2-abb7-97a21f1afd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d763e0>]}
[0m21:02:31.377272 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m21:02:31.377515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd223126-5329-48d2-abb7-97a21f1afd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d83d30>]}
[0m21:02:31.378668 [info ] [MainThread]: 
[0m21:02:31.379182 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:02:31.379914 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m21:02:31.380155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:32.037342 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m21:02:32.037849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:32.434141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd223126-5329-48d2-abb7-97a21f1afd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdd1ae0>]}
[0m21:02:32.435143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:32.435521 [info ] [MainThread]: 
[0m21:02:32.440152 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m21:02:32.440535 [info ] [Thread-1 (]: 1 of 1 START sql view model formula1.first_place_results ....................... [RUN]
[0m21:02:32.441287 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m21:02:32.441490 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m21:02:32.441687 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m21:02:32.445913 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m21:02:32.446605 [debug] [Thread-1 (]: finished collecting timing info
[0m21:02:32.446822 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m21:02:32.495945 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.first_place_results"
[0m21:02:32.496739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:32.498169 [debug] [Thread-1 (]: On model.formula1.first_place_results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.first_place_results"} */


  create or replace view `armin-playground`.`formula1`.`first_place_results`
  OPTIONS()
  as with first_place_winners as {
    select year, races.name, races.round, drivers.surname, drivers.forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from `armin-playground`.`formula1`.`results` as results
    inner join `armin-playground`.`formula1`.`drivers` as drivers on results.driverId = drivers.driverId
    inner join `armin-playground`.`formula1`.`races` as races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
}

select * from first_place_winners;


[0m21:02:32.926991 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" but got "{" at [6:34]')
[0m21:02:33.418944 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:3329904c-5c62-4e8d-ad8c-c7c485019136&page=queryresults
[0m21:02:33.419646 [debug] [Thread-1 (]: finished collecting timing info
[0m21:02:33.420315 [debug] [Thread-1 (]: Database Error in model first_place_results (models/example/first_place_results.sql)
  Syntax error: Expected "(" but got "{" at [6:34]
  compiled Code at target/run/formula1/models/example/first_place_results.sql
[0m21:02:33.420643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd223126-5329-48d2-abb7-97a21f1afd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112083460>]}
[0m21:02:33.421087 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model formula1.first_place_results .............. [[31mERROR[0m in 0.98s]
[0m21:02:33.421581 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m21:02:33.423077 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:02:33.423737 [info ] [MainThread]: 
[0m21:02:33.424087 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m21:02:33.424411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:33.424591 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m21:02:33.433550 [info ] [MainThread]: 
[0m21:02:33.433901 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:02:33.434204 [info ] [MainThread]: 
[0m21:02:33.434463 [error] [MainThread]: [33mDatabase Error in model first_place_results (models/example/first_place_results.sql)[0m
[0m21:02:33.434714 [error] [MainThread]:   Syntax error: Expected "(" but got "{" at [6:34]
[0m21:02:33.434955 [error] [MainThread]:   compiled Code at target/run/formula1/models/example/first_place_results.sql
[0m21:02:33.435199 [info ] [MainThread]: 
[0m21:02:33.435450 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:02:33.435792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e12ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f57d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112081a80>]}
[0m21:02:33.436063 [debug] [MainThread]: Flushing usage events


============================== 2022-12-31 21:04:34.706088 | 3b7b0280-8f37-438e-bc06-00e9c0bb8531 ==============================
[0m21:04:34.706165 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:04:34.706716 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:04:34.706870 [debug] [MainThread]: Tracking: tracking
[0m21:04:34.725823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4033d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b400970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4024a0>]}
[0m21:04:34.801263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:34.801781 [debug] [MainThread]: Partial parsing: updated file: formula1://models/example/first_place_results.sql
[0m21:04:34.817447 [debug] [MainThread]: 1699: static parser successfully parsed example/first_place_results.sql
[0m21:04:34.849265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b7b0280-8f37-438e-bc06-00e9c0bb8531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5efb20>]}
[0m21:04:34.857276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b7b0280-8f37-438e-bc06-00e9c0bb8531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b579540>]}
[0m21:04:34.857600 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m21:04:34.857893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b7b0280-8f37-438e-bc06-00e9c0bb8531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e71930>]}
[0m21:04:34.859529 [info ] [MainThread]: 
[0m21:04:34.860285 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:04:34.861283 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m21:04:34.861590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:35.446334 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m21:04:35.446837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:35.858031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b7b0280-8f37-438e-bc06-00e9c0bb8531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945db40>]}
[0m21:04:35.858837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:35.859189 [info ] [MainThread]: 
[0m21:04:35.862611 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m21:04:35.862950 [info ] [Thread-1 (]: 1 of 1 START sql view model formula1.first_place_results ....................... [RUN]
[0m21:04:35.863632 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m21:04:35.863827 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m21:04:35.864017 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m21:04:35.868125 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m21:04:35.868734 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:35.868943 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m21:04:35.906479 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.first_place_results"
[0m21:04:35.907287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:35.908832 [debug] [Thread-1 (]: On model.formula1.first_place_results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.first_place_results"} */


  create or replace view `armin-playground`.`formula1`.`first_place_results`
  OPTIONS()
  as with first_place_winners as {
    select year, races.name, races.round, drivers.surname, drivers.forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from (`armin-playground`.`formula1`.`results`) as results
    inner join `armin-playground`.`formula1`.`drivers` as drivers on results.driverId = drivers.driverId
    inner join `armin-playground`.`formula1`.`races` as races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
}

select * from first_place_winners;


[0m21:04:36.333881 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" but got "{" at [6:34]')
[0m21:04:36.548301 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:0f9c326c-396c-4be2-98b7-c5b30af2017e&page=queryresults
[0m21:04:36.548927 [debug] [Thread-1 (]: finished collecting timing info
[0m21:04:36.549634 [debug] [Thread-1 (]: Database Error in model first_place_results (models/example/first_place_results.sql)
  Syntax error: Expected "(" but got "{" at [6:34]
  compiled Code at target/run/formula1/models/example/first_place_results.sql
[0m21:04:36.549979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7b0280-8f37-438e-bc06-00e9c0bb8531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ac430>]}
[0m21:04:36.550439 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model formula1.first_place_results .............. [[31mERROR[0m in 0.69s]
[0m21:04:36.550971 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m21:04:36.552391 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:04:36.553022 [info ] [MainThread]: 
[0m21:04:36.553342 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m21:04:36.553631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:36.553790 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m21:04:36.657805 [info ] [MainThread]: 
[0m21:04:36.658244 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:04:36.658619 [info ] [MainThread]: 
[0m21:04:36.658947 [error] [MainThread]: [33mDatabase Error in model first_place_results (models/example/first_place_results.sql)[0m
[0m21:04:36.659241 [error] [MainThread]:   Syntax error: Expected "(" but got "{" at [6:34]
[0m21:04:36.659519 [error] [MainThread]:   compiled Code at target/run/formula1/models/example/first_place_results.sql
[0m21:04:36.659806 [info ] [MainThread]: 
[0m21:04:36.660095 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:04:36.660487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936c8e0>]}
[0m21:04:36.660808 [debug] [MainThread]: Flushing usage events


============================== 2022-12-31 21:04:59.068202 | a13d5811-6bef-48a5-b42b-1ea47d89f38c ==============================
[0m21:04:59.068306 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:04:59.068833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:04:59.068983 [debug] [MainThread]: Tracking: tracking
[0m21:04:59.087963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a402b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a402a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a402680>]}
[0m21:04:59.161464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:04:59.161925 [debug] [MainThread]: Partial parsing: updated file: formula1://models/example/first_place_results.sql
[0m21:04:59.176561 [debug] [MainThread]: 1699: static parser successfully parsed example/first_place_results.sql
[0m21:04:59.204940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a13d5811-6bef-48a5-b42b-1ea47d89f38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e3dc0>]}
[0m21:04:59.211200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a13d5811-6bef-48a5-b42b-1ea47d89f38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a682ec0>]}
[0m21:04:59.211452 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m21:04:59.211686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a13d5811-6bef-48a5-b42b-1ea47d89f38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5dc90>]}
[0m21:04:59.212884 [info ] [MainThread]: 
[0m21:04:59.213374 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:04:59.214127 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m21:04:59.214353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:59.817523 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m21:04:59.818034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:00.212389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a13d5811-6bef-48a5-b42b-1ea47d89f38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f7e80>]}
[0m21:05:00.213381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:00.213733 [info ] [MainThread]: 
[0m21:05:00.217311 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m21:05:00.217634 [info ] [Thread-1 (]: 1 of 1 START sql view model formula1.first_place_results ....................... [RUN]
[0m21:05:00.218336 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m21:05:00.218528 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m21:05:00.218714 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m21:05:00.222753 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m21:05:00.223427 [debug] [Thread-1 (]: finished collecting timing info
[0m21:05:00.223658 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m21:05:00.264891 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.first_place_results"
[0m21:05:00.265715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:00.267258 [debug] [Thread-1 (]: On model.formula1.first_place_results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.first_place_results"} */


  create or replace view `armin-playground`.`formula1`.`first_place_results`
  OPTIONS()
  as with first_place_winners as (
    select year, races.name, races.round, drivers.surname, drivers.forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from `armin-playground`.`formula1`.`results` as results
    inner join `armin-playground`.`formula1`.`drivers` as drivers on results.driverId = drivers.driverId
    inner join `armin-playground`.`formula1`.`races` as races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from first_place_winners;


[0m21:05:01.197259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:7a385f4c-77ba-4b42-ab7e-b91bac358b83:us-east4&page=queryresults
[0m21:05:01.220331 [debug] [Thread-1 (]: finished collecting timing info
[0m21:05:01.220923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13d5811-6bef-48a5-b42b-1ea47d89f38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e99f0>]}
[0m21:05:01.221301 [info ] [Thread-1 (]: 1 of 1 OK created sql view model formula1.first_place_results .................. [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m21:05:01.221742 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m21:05:01.222940 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:05:01.223450 [info ] [MainThread]: 
[0m21:05:01.223730 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m21:05:01.223993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:01.224137 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m21:05:01.320321 [info ] [MainThread]: 
[0m21:05:01.320709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:01.321057 [info ] [MainThread]: 
[0m21:05:01.321347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:05:01.321731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a328c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067334f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069976d0>]}
[0m21:05:01.322041 [debug] [MainThread]: Flushing usage events


============================== 2022-12-31 21:08:44.212883 | 5541d320-132d-4e8c-bbd3-d32866bf1d64 ==============================
[0m21:08:44.213030 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:08:44.213583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:08:44.213854 [debug] [MainThread]: Tracking: tracking
[0m21:08:44.232148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8789d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87a500>]}
[0m21:08:44.278800 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:08:44.279237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5541d320-132d-4e8c-bbd3-d32866bf1d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d1300>]}
[0m21:08:44.311397 [debug] [MainThread]: Parsing macros/etc.sql
[0m21:08:44.314221 [debug] [MainThread]: Parsing macros/catalog.sql
[0m21:08:44.322552 [debug] [MainThread]: Parsing macros/adapters.sql
[0m21:08:44.349452 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m21:08:44.352778 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m21:08:44.356164 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m21:08:44.365276 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m21:08:44.368624 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m21:08:44.387974 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m21:08:44.389612 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:08:44.390002 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:08:44.390622 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m21:08:44.391642 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:08:44.392001 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:08:44.392530 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:08:44.393116 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:08:44.394006 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:08:44.395087 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:08:44.395574 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:08:44.396047 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:08:44.396562 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m21:08:44.397054 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:08:44.397474 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:08:44.398775 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:08:44.399409 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m21:08:44.400146 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m21:08:44.400690 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:08:44.402895 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m21:08:44.406211 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m21:08:44.408591 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m21:08:44.410059 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m21:08:44.425877 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m21:08:44.441329 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m21:08:44.454572 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m21:08:44.459367 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m21:08:44.461098 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m21:08:44.462985 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m21:08:44.469965 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m21:08:44.483971 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m21:08:44.485276 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m21:08:44.491279 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m21:08:44.500376 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m21:08:44.515327 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m21:08:44.520480 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m21:08:44.523531 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m21:08:44.528317 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m21:08:44.529465 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m21:08:44.532359 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m21:08:44.534426 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m21:08:44.540732 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m21:08:44.557574 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m21:08:44.558923 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m21:08:44.561027 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m21:08:44.562386 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m21:08:44.563146 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m21:08:44.563854 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m21:08:44.564461 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m21:08:44.565894 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m21:08:44.570704 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m21:08:44.578260 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m21:08:44.579021 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m21:08:44.580113 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m21:08:44.580993 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m21:08:44.582163 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m21:08:44.583385 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m21:08:44.584128 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m21:08:44.585055 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m21:08:44.586133 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m21:08:44.588124 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m21:08:44.589250 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m21:08:44.590401 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m21:08:44.591373 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m21:08:44.592311 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m21:08:44.593140 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m21:08:44.594094 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m21:08:44.594925 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m21:08:44.600984 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m21:08:44.601943 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m21:08:44.602793 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m21:08:44.604470 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m21:08:44.606757 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m21:08:44.607708 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m21:08:44.609035 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m21:08:44.609990 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m21:08:44.611882 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m21:08:44.615296 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m21:08:44.617819 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m21:08:44.631377 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m21:08:44.633088 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m21:08:44.645258 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m21:08:44.649058 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m21:08:44.655242 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m21:08:44.663606 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m21:08:44.668774 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m21:08:44.982428 [debug] [MainThread]: 1699: static parser successfully parsed example/first_place_results.sql
[0m21:08:45.041251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5541d320-132d-4e8c-bbd3-d32866bf1d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba39a50>]}
[0m21:08:45.047055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5541d320-132d-4e8c-bbd3-d32866bf1d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87b640>]}
[0m21:08:45.047266 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m21:08:45.047467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5541d320-132d-4e8c-bbd3-d32866bf1d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b84ece0>]}
[0m21:08:45.048801 [info ] [MainThread]: 
[0m21:08:45.049408 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:08:45.050314 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m21:08:45.050553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:45.554033 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m21:08:45.554509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:45.917858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5541d320-132d-4e8c-bbd3-d32866bf1d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109899b40>]}
[0m21:08:45.918868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:45.919222 [info ] [MainThread]: 
[0m21:08:45.922734 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m21:08:45.923069 [info ] [Thread-1 (]: 1 of 1 START sql table model formula1.first_place_results ...................... [RUN]
[0m21:08:45.923725 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m21:08:45.923910 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m21:08:45.924088 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m21:08:45.928072 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m21:08:45.928750 [debug] [Thread-1 (]: finished collecting timing info
[0m21:08:45.928987 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m21:08:45.985846 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.first_place_results"
[0m21:08:45.986541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:45.987897 [debug] [Thread-1 (]: On model.formula1.first_place_results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.first_place_results"} */

  
    

    create or replace table `armin-playground`.`formula1`.`first_place_results`
    
    
    OPTIONS()
    as (
      with first_place_winners as (
    select year, races.name, races.round, drivers.surname, drivers.forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from `armin-playground`.`formula1`.`results` as results
    inner join `armin-playground`.`formula1`.`drivers` as drivers on results.driverId = drivers.driverId
    inner join `armin-playground`.`formula1`.`races` as races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from first_place_winners
    );
  
[0m21:08:48.289241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:e5dbcb3f-b9b9-46a1-bb8d-add80a52d841:us-east4&page=queryresults
[0m21:08:48.307530 [debug] [Thread-1 (]: finished collecting timing info
[0m21:08:48.308160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5541d320-132d-4e8c-bbd3-d32866bf1d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb780d0>]}
[0m21:08:48.308542 [info ] [Thread-1 (]: 1 of 1 OK created sql table model formula1.first_place_results ................. [[32mCREATE TABLE (1.1k rows, 1.4 MB processed)[0m in 2.38s]
[0m21:08:48.308990 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m21:08:48.310257 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:08:48.310806 [info ] [MainThread]: 
[0m21:08:48.311103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m21:08:48.311385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:48.311537 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m21:08:48.320059 [info ] [MainThread]: 
[0m21:08:48.320553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:48.320936 [info ] [MainThread]: 
[0m21:08:48.321288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:08:48.321712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b5b10>]}
[0m21:08:48.322022 [debug] [MainThread]: Flushing usage events


============================== 2022-12-31 21:10:33.379170 | ab1c2db8-a098-4b0e-bed4-5ff192453499 ==============================
[0m21:10:33.379194 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:10:33.379820 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m21:10:33.380015 [debug] [MainThread]: Tracking: tracking
[0m21:10:33.397441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7248b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7271f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7266e0>]}
[0m21:10:33.468438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:10:33.468635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:10:33.474272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab1c2db8-a098-4b0e-bed4-5ff192453499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ec310>]}
[0m21:10:33.481431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab1c2db8-a098-4b0e-bed4-5ff192453499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bcfa0>]}
[0m21:10:33.481703 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m21:10:33.481946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab1c2db8-a098-4b0e-bed4-5ff192453499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8826b0>]}
[0m21:10:33.483202 [info ] [MainThread]: 
[0m21:10:33.483776 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m21:10:33.484456 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m21:10:33.484668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:33.886359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab1c2db8-a098-4b0e-bed4-5ff192453499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8afdc0>]}
[0m21:10:33.887264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:33.887623 [info ] [MainThread]: 
[0m21:10:33.891111 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m21:10:33.891701 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m21:10:33.891900 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m21:10:33.892089 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m21:10:33.896307 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m21:10:33.896929 [debug] [Thread-1 (]: finished collecting timing info
[0m21:10:33.897150 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m21:10:33.897350 [debug] [Thread-1 (]: finished collecting timing info
[0m21:10:33.898098 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m21:10:33.899175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:33.899416 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m21:10:33.911840 [info ] [MainThread]: Done.
[0m21:10:33.915496 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m21:10:33.915736 [info ] [MainThread]: Building catalog
[0m21:10:33.917442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:34.466900 [debug] [ThreadPool]: Acquiring new bigquery connection "armin-playground.information_schema"
[0m21:10:34.485892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:34.487293 [debug] [ThreadPool]: On armin-playground.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "connection_name": "armin-playground.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `armin-playground`.`formula1`.__TABLES__
        where (upper(dataset_id) = upper('formula1'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m21:10:37.466026 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:17ce605a-8745-4466-8f26-6a5e8ecde40a:us-east4&page=queryresults
[0m21:10:37.617471 [info ] [MainThread]: Catalog written to /Users/arminefendic/Documents/dbt_projects/formula1/target/catalog.json
[0m21:10:37.618006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a2770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109183d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914e7d0>]}
[0m21:10:37.618279 [debug] [MainThread]: Flushing usage events
[0m21:10:37.825490 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:10:37.825815 [debug] [MainThread]: Connection 'armin-playground.information_schema' was properly closed.


============================== 2022-12-31 21:10:49.187087 | 285f101c-0368-43cf-896d-157df88c0937 ==============================
[0m21:10:49.187150 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:10:49.187773 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m21:10:49.188058 [debug] [MainThread]: Tracking: tracking
[0m21:10:49.205927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be25f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be272e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be26830>]}
[0m21:10:49.210457 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m21:10:49.210941 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m21:10:49.211221 [info ] [MainThread]: 
[0m21:10:49.211459 [info ] [MainThread]: 
[0m21:10:49.211698 [info ] [MainThread]: Press Ctrl+C to exit.
[0m19:43:20.281639 [debug] [MainThread]: Flushing usage events
[0m19:43:20.608658 [info ] [MainThread]: ctrl-c


============================== 2023-01-01 23:28:27.372362 | b263eba7-5963-4a8d-a005-5edb8246806a ==============================
[0m23:28:27.372389 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:28:27.373360 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m23:28:27.373589 [debug] [MainThread]: Tracking: tracking
[0m23:28:27.397077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a797160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a797190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7966e0>]}
[0m23:28:27.446981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a91f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a91f460>]}
[0m23:28:27.447287 [debug] [MainThread]: Flushing usage events
[0m23:28:27.776482 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/example/models.yml is invalid because the yml property file models/example/models.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2023-01-01 23:28:35.759192 | c979f12c-8ea9-4a60-a1bd-bc2c0bddd7dd ==============================
[0m23:28:35.759218 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:28:35.759771 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m23:28:35.760010 [debug] [MainThread]: Tracking: tracking
[0m23:28:35.778533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1cca0>]}
[0m23:28:35.783330 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m23:28:35.783826 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m23:28:35.784080 [info ] [MainThread]: 
[0m23:28:35.784305 [info ] [MainThread]: 
[0m23:28:35.784529 [info ] [MainThread]: Press Ctrl+C to exit.
[0m23:38:04.526300 [debug] [MainThread]: Flushing usage events
[0m23:38:04.885062 [info ] [MainThread]: ctrl-c


============================== 2023-01-01 23:38:11.171747 | 4db07728-d630-4ad9-896a-fb441ccdf104 ==============================
[0m23:38:11.171785 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:38:11.172528 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:38:11.172746 [debug] [MainThread]: Tracking: tracking
[0m23:38:11.189525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109934820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099371f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109936650>]}
[0m23:38:11.275593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:11.276109 [debug] [MainThread]: Partial parsing: update schema file: formula1://models/example/formula1_src.yml
[0m23:38:11.302610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4db07728-d630-4ad9-896a-fb441ccdf104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2e110>]}
[0m23:38:11.310918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4db07728-d630-4ad9-896a-fb441ccdf104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af1f00>]}
[0m23:38:11.311233 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m23:38:11.311487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db07728-d630-4ad9-896a-fb441ccdf104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af2830>]}
[0m23:38:11.312928 [info ] [MainThread]: 
[0m23:38:11.313545 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m23:38:11.314825 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m23:38:11.315126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:12.142640 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m23:38:12.143109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:12.712133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db07728-d630-4ad9-896a-fb441ccdf104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107955b40>]}
[0m23:38:12.713015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:38:12.713395 [info ] [MainThread]: 
[0m23:38:12.719285 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m23:38:12.719757 [info ] [Thread-1 (]: 1 of 1 START sql table model formula1.first_place_results ...................... [RUN]
[0m23:38:12.720617 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m23:38:12.720879 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m23:38:12.721124 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m23:38:12.725421 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m23:38:12.726577 [debug] [Thread-1 (]: finished collecting timing info
[0m23:38:12.726883 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m23:38:12.746209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:13.352293 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.first_place_results"
[0m23:38:13.352883 [debug] [Thread-1 (]: On model.formula1.first_place_results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.first_place_results"} */

  
    

    create or replace table `armin-playground`.`formula1`.`first_place_results`
    
    
    OPTIONS()
    as (
      with first_place_winners as (
    select year, races.name, races.round, drivers.surname, drivers.forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from `armin-playground`.`formula1`.`results` as results
    inner join `armin-playground`.`formula1`.`drivers` as drivers on results.driverId = drivers.driverId
    inner join `armin-playground`.`formula1`.`races` as races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from first_place_winners
    );
  
[0m23:38:15.771560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:257650ac-4cb0-4b5a-87af-464da3016853:us-east4&page=queryresults
[0m23:38:15.796683 [debug] [Thread-1 (]: finished collecting timing info
[0m23:38:15.797254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4db07728-d630-4ad9-896a-fb441ccdf104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bef2e0>]}
[0m23:38:15.797603 [info ] [Thread-1 (]: 1 of 1 OK created sql table model formula1.first_place_results ................. [[32mCREATE TABLE (1.1k rows, 1.4 MB processed)[0m in 3.08s]
[0m23:38:15.798006 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m23:38:15.799129 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m23:38:15.799618 [info ] [MainThread]: 
[0m23:38:15.799879 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m23:38:15.800127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:15.800269 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m23:38:15.891306 [info ] [MainThread]: 
[0m23:38:15.891676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:15.892014 [info ] [MainThread]: 
[0m23:38:15.892381 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:38:15.892763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c40040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d32f20>]}
[0m23:38:15.893050 [debug] [MainThread]: Flushing usage events


============================== 2023-01-01 23:39:44.845527 | fe8d4486-d5b3-4f6d-8bb0-f0033bc93e92 ==============================
[0m23:39:44.845667 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:39:44.846393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m23:39:44.846664 [debug] [MainThread]: Tracking: tracking
[0m23:39:44.867166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11469dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11469f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11469e5c0>]}
[0m23:39:44.935055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:44.935241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:44.940132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe8d4486-d5b3-4f6d-8bb0-f0033bc93e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114864340>]}
[0m23:39:44.946533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe8d4486-d5b3-4f6d-8bb0-f0033bc93e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114835090>]}
[0m23:39:44.946760 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m23:39:44.946991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe8d4486-d5b3-4f6d-8bb0-f0033bc93e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114834fd0>]}
[0m23:39:44.948209 [info ] [MainThread]: 
[0m23:39:44.948730 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m23:39:44.949606 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m23:39:44.949907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:45.397296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe8d4486-d5b3-4f6d-8bb0-f0033bc93e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114827e20>]}
[0m23:39:45.398215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:45.398572 [info ] [MainThread]: 
[0m23:39:45.402110 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m23:39:45.402736 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m23:39:45.402939 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m23:39:45.403131 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m23:39:45.408127 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m23:39:45.408889 [debug] [Thread-1 (]: finished collecting timing info
[0m23:39:45.409190 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m23:39:45.409420 [debug] [Thread-1 (]: finished collecting timing info
[0m23:39:45.410165 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m23:39:45.411126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:45.411323 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m23:39:45.424074 [info ] [MainThread]: Done.
[0m23:39:45.427088 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m23:39:45.427354 [info ] [MainThread]: Building catalog
[0m23:39:45.429086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:46.136652 [debug] [ThreadPool]: Acquiring new bigquery connection "armin-playground.information_schema"
[0m23:39:46.155461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:46.156823 [debug] [ThreadPool]: On armin-playground.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "connection_name": "armin-playground.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `armin-playground`.`formula1`.__TABLES__
        where (upper(dataset_id) = upper('formula1'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:39:48.672726 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:42ba5604-77a2-429e-8ddc-317ae6ae03ec:us-east4&page=queryresults
[0m23:39:48.826043 [info ] [MainThread]: Catalog written to /Users/arminefendic/Documents/dbt_projects/formula1/target/catalog.json
[0m23:39:48.826572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fe5600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f4910>]}
[0m23:39:48.826848 [debug] [MainThread]: Flushing usage events
[0m23:39:49.087645 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:39:49.087985 [debug] [MainThread]: Connection 'armin-playground.information_schema' was properly closed.


============================== 2023-01-01 23:39:58.199529 | 0624d677-7c6e-4471-8c4a-425cf04bf1a8 ==============================
[0m23:39:58.199554 [info ] [MainThread]: Running with dbt=1.3.1
[0m23:39:58.200151 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m23:39:58.200355 [debug] [MainThread]: Tracking: tracking
[0m23:39:58.215247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0e9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0eb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0eb1c0>]}
[0m23:39:58.218874 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m23:39:58.219303 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m23:39:58.219590 [info ] [MainThread]: 
[0m23:39:58.219877 [info ] [MainThread]: 
[0m23:39:58.220269 [info ] [MainThread]: Press Ctrl+C to exit.
[0m01:01:57.476522 [debug] [MainThread]: Flushing usage events
[0m01:01:57.652818 [info ] [MainThread]: ctrl-c


============================== 2023-01-02 01:02:03.907212 | 6b54cd44-2bb1-4387-99f5-61b07f6654b4 ==============================
[0m01:02:03.907315 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:02:03.907964 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:02:03.908292 [debug] [MainThread]: Tracking: tracking
[0m01:02:03.926555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0c490>]}
[0m01:02:03.996431 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m01:02:03.996836 [debug] [MainThread]: Partial parsing: added file: formula1://models/staging/first_place_results.sql
[0m01:02:03.997139 [debug] [MainThread]: Partial parsing: added file: formula1://models/schema.yml
[0m01:02:03.997348 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.circuits
[0m01:02:03.997489 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.constructor_results
[0m01:02:03.997617 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.constructor_standings
[0m01:02:03.997744 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.constructors
[0m01:02:03.997869 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.driver_standings
[0m01:02:03.997994 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.drivers
[0m01:02:03.998118 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.lap_times
[0m01:02:03.998241 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.pit_stops
[0m01:02:03.998362 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.qualifying
[0m01:02:03.998484 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.races
[0m01:02:03.998612 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.results
[0m01:02:03.998734 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.seasons
[0m01:02:03.998856 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.sprint_results
[0m01:02:03.998976 [debug] [MainThread]: Partial parsing: deleted source source.formula1.formula1.status
[0m01:02:03.999116 [debug] [MainThread]: Partial parsing: deleted file: formula1://models/example/first_place_results.sql
[0m01:02:04.014367 [debug] [MainThread]: 1699: static parser successfully parsed staging/first_place_results.sql
[0m01:02:04.061910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b54cd44-2bb1-4387-99f5-61b07f6654b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac84cd0>]}
[0m01:02:04.068229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b54cd44-2bb1-4387-99f5-61b07f6654b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab85900>]}
[0m01:02:04.068505 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m01:02:04.068840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b54cd44-2bb1-4387-99f5-61b07f6654b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab85a50>]}
[0m01:02:04.070089 [info ] [MainThread]: 
[0m01:02:04.070603 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:02:04.071364 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m01:02:04.071556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:04.596903 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m01:02:04.597431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:04.972478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b54cd44-2bb1-4387-99f5-61b07f6654b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2dab0>]}
[0m01:02:04.973428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:04.973784 [info ] [MainThread]: 
[0m01:02:05.046019 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m01:02:05.046442 [info ] [Thread-1 (]: 1 of 1 START sql table model formula1.first_place_results ...................... [RUN]
[0m01:02:05.049881 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m01:02:05.050137 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m01:02:05.050368 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m01:02:05.055059 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m01:02:05.055924 [debug] [Thread-1 (]: finished collecting timing info
[0m01:02:05.056182 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m01:02:05.075917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:05.512509 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.first_place_results"
[0m01:02:05.513292 [debug] [Thread-1 (]: On model.formula1.first_place_results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.first_place_results"} */

  
    

    create or replace table `armin-playground`.`formula1`.`first_place_results`
    
    
    OPTIONS()
    as (
      with first_place_winners as (
    select year, races.name, races.round, drivers.surname, drivers.forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from `armin-playground`.`formula1`.`results` as results
    inner join `armin-playground`.`formula1`.`drivers` as drivers on results.driverId = drivers.driverId
    inner join `armin-playground`.`formula1`.`races` as races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from first_place_winners
    );
  
[0m01:02:07.796569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:b99ef56f-935b-4404-8b82-ed0dd6c27e70:us-east4&page=queryresults
[0m01:02:07.817353 [debug] [Thread-1 (]: finished collecting timing info
[0m01:02:07.817948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b54cd44-2bb1-4387-99f5-61b07f6654b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0e230>]}
[0m01:02:07.818325 [info ] [Thread-1 (]: 1 of 1 OK created sql table model formula1.first_place_results ................. [[32mCREATE TABLE (1.1k rows, 1.4 MB processed)[0m in 2.77s]
[0m01:02:07.818772 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m01:02:07.820033 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:02:07.820553 [info ] [MainThread]: 
[0m01:02:07.820837 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m01:02:07.821104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:07.821255 [debug] [MainThread]: Connection 'model.formula1.first_place_results' was properly closed.
[0m01:02:07.829475 [info ] [MainThread]: 
[0m01:02:07.829814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:07.830116 [info ] [MainThread]: 
[0m01:02:07.830363 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:02:07.830694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087764a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab6dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a99d810>]}
[0m01:02:07.830962 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 01:31:32.459358 | 196b3d48-fb58-4c97-a997-cff954707be0 ==============================
[0m01:31:32.459452 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:31:32.459939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:31:32.460197 [debug] [MainThread]: Tracking: tracking
[0m01:31:32.478168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065520b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106552230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106552470>]}
[0m01:31:32.517143 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:31:32.517574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e2950>]}
[0m01:31:32.543173 [debug] [MainThread]: Parsing macros/etc.sql
[0m01:31:32.545427 [debug] [MainThread]: Parsing macros/catalog.sql
[0m01:31:32.550856 [debug] [MainThread]: Parsing macros/adapters.sql
[0m01:31:32.569836 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m01:31:32.572109 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m01:31:32.574523 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m01:31:32.580894 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m01:31:32.583181 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m01:31:32.598167 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m01:31:32.599658 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m01:31:32.600003 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m01:31:32.600552 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m01:31:32.601494 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m01:31:32.601834 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m01:31:32.602337 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m01:31:32.602906 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m01:31:32.603764 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m01:31:32.604808 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m01:31:32.605269 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m01:31:32.605726 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m01:31:32.606217 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m01:31:32.606685 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m01:31:32.607092 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m01:31:32.608310 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m01:31:32.608788 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m01:31:32.609504 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m01:31:32.610033 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m01:31:32.612203 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m01:31:32.615466 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m01:31:32.617419 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m01:31:32.618802 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m01:31:32.632362 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m01:31:32.643080 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m01:31:32.652785 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m01:31:32.656807 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m01:31:32.658265 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m01:31:32.659927 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m01:31:32.667036 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m01:31:32.679851 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m01:31:32.681078 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m01:31:32.686744 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m01:31:32.695300 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m01:31:32.709049 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m01:31:32.713497 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m01:31:32.716362 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m01:31:32.720788 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m01:31:32.721864 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m01:31:32.724572 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m01:31:32.726548 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m01:31:32.732577 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m01:31:32.747736 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m01:31:32.748953 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m01:31:32.750975 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m01:31:32.752269 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m01:31:32.752996 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m01:31:32.753677 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m01:31:32.754257 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m01:31:32.755381 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m01:31:32.759742 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m01:31:32.766582 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m01:31:32.767290 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m01:31:32.768311 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m01:31:32.769135 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m01:31:32.769938 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m01:31:32.770984 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m01:31:32.771692 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m01:31:32.772633 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m01:31:32.773671 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m01:31:32.775552 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m01:31:32.776598 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m01:31:32.777525 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m01:31:32.778437 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m01:31:32.779332 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m01:31:32.780135 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m01:31:32.781052 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m01:31:32.781837 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m01:31:32.787461 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m01:31:32.788355 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m01:31:32.789149 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m01:31:32.790645 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m01:31:32.792455 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m01:31:32.793340 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m01:31:32.794599 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m01:31:32.795501 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m01:31:32.797288 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m01:31:32.800088 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m01:31:32.802403 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m01:31:32.814692 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m01:31:32.816314 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m01:31:32.827840 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m01:31:32.831465 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m01:31:32.837275 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m01:31:32.845175 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m01:31:32.850248 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m01:31:33.164715 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_formula1__drivers.sql
[0m01:31:33.174956 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_formula1__races.sql
[0m01:31:33.177529 [debug] [MainThread]: 1699: static parser successfully parsed staging/first_place_results.sql
[0m01:31:33.179894 [debug] [MainThread]: 1603: static parser failed on staging/stg_formula1__results.sql
[0m01:31:33.183295 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_formula1__results.sql
[0m01:31:33.184408 [debug] [MainThread]: 1699: static parser successfully parsed marts/top_drivers.sql
[0m01:31:33.234356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m01:31:33.238896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106526140>]}
[0m01:31:33.247589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106550190>]}
[0m01:31:33.247888 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m01:31:33.248099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a7f40>]}
[0m01:31:33.249404 [info ] [MainThread]: 
[0m01:31:33.249951 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:31:33.250818 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m01:31:33.251041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:33.781343 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m01:31:33.781764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:34.141603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104579ba0>]}
[0m01:31:34.142474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:34.142829 [info ] [MainThread]: 
[0m01:31:34.148931 [debug] [Thread-1 (]: Began running node model.formula1.first_place_results
[0m01:31:34.149271 [info ] [Thread-1 (]: 1 of 5 START sql view model formula1.first_place_results ....................... [RUN]
[0m01:31:34.149965 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.first_place_results"
[0m01:31:34.150163 [debug] [Thread-1 (]: Began compiling node model.formula1.first_place_results
[0m01:31:34.150347 [debug] [Thread-1 (]: Compiling model.formula1.first_place_results
[0m01:31:34.156557 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.first_place_results"
[0m01:31:34.157198 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:34.157403 [debug] [Thread-1 (]: Began executing node model.formula1.first_place_results
[0m01:31:34.183585 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:34.184259 [debug] [Thread-1 (]: Compilation Error in model first_place_results (models/staging/first_place_results.sql)
  Trying to create view `armin-playground`.`formula1`.`first_place_results`, but it currently exists as a table. Either drop `armin-playground`.`formula1`.`first_place_results` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model first_place_results (models/staging/first_place_results.sql)
[0m01:31:34.184572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106739270>]}
[0m01:31:34.184954 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model formula1.first_place_results .............. [[31mERROR[0m in 0.03s]
[0m01:31:34.185411 [debug] [Thread-1 (]: Finished running node model.formula1.first_place_results
[0m01:31:34.185639 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m01:31:34.186133 [info ] [Thread-1 (]: 2 of 5 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m01:31:34.186850 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m01:31:34.187043 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m01:31:34.187213 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m01:31:34.190380 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m01:31:34.191069 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:34.191331 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m01:31:34.213724 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m01:31:34.214383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:34.215728 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m01:31:35.083180 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:a50df20c-e23c-44ea-b81f-95cd77c58b43:us-east4&page=queryresults
[0m01:31:35.100723 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:35.101334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106715510>]}
[0m01:31:35.101694 [info ] [Thread-1 (]: 2 of 5 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m01:31:35.102116 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m01:31:35.102339 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m01:31:35.102664 [info ] [Thread-1 (]: 3 of 5 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m01:31:35.103304 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m01:31:35.103486 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m01:31:35.103654 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m01:31:35.106584 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m01:31:35.107151 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:35.107343 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m01:31:35.114804 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m01:31:35.115534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:35.116908 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m01:31:36.507957 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:d3e134f0-607a-48c7-a409-18656f284c99:us-east4&page=queryresults
[0m01:31:36.509956 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:36.510670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106898df0>]}
[0m01:31:36.511079 [info ] [Thread-1 (]: 3 of 5 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m01:31:36.511564 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m01:31:36.511820 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m01:31:36.512330 [info ] [Thread-1 (]: 4 of 5 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m01:31:36.513066 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m01:31:36.513252 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m01:31:36.513421 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m01:31:36.522181 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:36.522904 [debug] [Thread-1 (]: Compilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:31:36.523179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685ada0>]}
[0m01:31:36.523550 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model formula1.stg_formula1__results ............ [[31mERROR[0m in 0.01s]
[0m01:31:36.523968 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m01:31:36.524192 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m01:31:36.524564 [info ] [Thread-1 (]: 5 of 5 START sql table model formula1.top_drivers .............................. [RUN]
[0m01:31:36.525242 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m01:31:36.525429 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m01:31:36.525607 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m01:31:36.531774 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m01:31:36.532569 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:36.532788 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m01:31:36.565996 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m01:31:36.566838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:36.568227 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
)

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m01:31:36.947084 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "races_drivers_results_joined" at [25:1]')
[0m01:31:37.812623 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:f680f9ff-dd47-4352-959e-0c3671d711bf&page=queryresults
[0m01:31:37.813328 [debug] [Thread-1 (]: finished collecting timing info
[0m01:31:37.814176 [debug] [Thread-1 (]: Database Error in model top_drivers (models/marts/top_drivers.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "races_drivers_results_joined" at [25:1]
  compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m01:31:37.814546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196b3d48-fb58-4c97-a997-cff954707be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f9630>]}
[0m01:31:37.814987 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model formula1.top_drivers ..................... [[31mERROR[0m in 1.29s]
[0m01:31:37.815508 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m01:31:37.817092 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:31:37.817806 [info ] [MainThread]: 
[0m01:31:37.818162 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m01:31:37.818485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:37.818667 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m01:31:37.827610 [info ] [MainThread]: 
[0m01:31:37.827933 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m01:31:37.828225 [info ] [MainThread]: 
[0m01:31:37.828475 [error] [MainThread]: [33mCompilation Error in model first_place_results (models/staging/first_place_results.sql)[0m
[0m01:31:37.828720 [error] [MainThread]:   Trying to create view `armin-playground`.`formula1`.`first_place_results`, but it currently exists as a table. Either drop `armin-playground`.`formula1`.`first_place_results` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m01:31:37.828951 [error] [MainThread]:   
[0m01:31:37.829177 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m01:31:37.829400 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m01:31:37.829619 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m01:31:37.829841 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m01:31:37.830062 [error] [MainThread]:   > called by model first_place_results (models/staging/first_place_results.sql)
[0m01:31:37.830285 [info ] [MainThread]: 
[0m01:31:37.830512 [error] [MainThread]: [33mCompilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)[0m
[0m01:31:37.830738 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:31:37.830965 [info ] [MainThread]: 
[0m01:31:37.831191 [error] [MainThread]: [33mDatabase Error in model top_drivers (models/marts/top_drivers.sql)[0m
[0m01:31:37.831415 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "races_drivers_results_joined" at [25:1]
[0m01:31:37.831634 [error] [MainThread]:   compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m01:31:37.831867 [info ] [MainThread]: 
[0m01:31:37.832100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m01:31:37.832430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685ad70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106722d70>]}
[0m01:31:37.832688 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 01:32:46.387781 | 07b914f5-67a9-4519-af98-de301d14a428 ==============================
[0m01:32:46.387808 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:32:46.388519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:32:46.388769 [debug] [MainThread]: Tracking: tracking
[0m01:32:46.408083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118847c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118863b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118865f0>]}
[0m01:32:46.482310 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m01:32:46.482659 [debug] [MainThread]: Partial parsing: deleted file: formula1://models/staging/first_place_results.sql
[0m01:32:46.491562 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'first_place_results' in the 'models' section of file 'models/schema.yml'
[0m01:32:46.508274 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m01:32:46.515962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9feb0>]}
[0m01:32:46.525748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111815c60>]}
[0m01:32:46.526261 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m01:32:46.526583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a06200>]}
[0m01:32:46.528451 [info ] [MainThread]: 
[0m01:32:46.529224 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:32:46.530499 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m01:32:46.530810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:47.015464 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m01:32:47.015876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:47.380288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8e1b70>]}
[0m01:32:47.381185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:47.381540 [info ] [MainThread]: 
[0m01:32:47.385029 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m01:32:47.385364 [info ] [Thread-1 (]: 1 of 4 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m01:32:47.386052 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m01:32:47.386256 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m01:32:47.386448 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m01:32:47.389694 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m01:32:47.390341 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:47.390595 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m01:32:47.430469 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m01:32:47.431189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:47.432917 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m01:32:48.034210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:ce8672c5-7eda-4a09-9b5f-e04eb9254cdc:us-east4&page=queryresults
[0m01:32:48.060688 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:48.061493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1c6a0>]}
[0m01:32:48.061935 [info ] [Thread-1 (]: 1 of 4 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m01:32:48.062436 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m01:32:48.062689 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m01:32:48.063147 [info ] [Thread-1 (]: 2 of 4 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m01:32:48.063954 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m01:32:48.064171 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m01:32:48.064354 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m01:32:48.154064 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m01:32:48.154793 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:48.155067 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m01:32:48.158916 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m01:32:48.159466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:48.161024 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m01:32:48.905565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:ab0605ef-b0ca-4b75-ad80-b6402e77a1cd:us-east4&page=queryresults
[0m01:32:48.907912 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:48.908608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9dd80>]}
[0m01:32:48.909028 [info ] [Thread-1 (]: 2 of 4 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m01:32:48.909517 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m01:32:48.909773 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m01:32:48.910255 [info ] [Thread-1 (]: 3 of 4 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m01:32:48.910923 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m01:32:48.911110 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m01:32:48.911285 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m01:32:48.914976 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:48.915560 [debug] [Thread-1 (]: Compilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:32:48.915820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11198b700>]}
[0m01:32:48.916180 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model formula1.stg_formula1__results ............ [[31mERROR[0m in 0.01s]
[0m01:32:48.916594 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m01:32:48.916811 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m01:32:48.917163 [info ] [Thread-1 (]: 4 of 4 START sql table model formula1.top_drivers .............................. [RUN]
[0m01:32:48.917827 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m01:32:48.918015 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m01:32:48.918193 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m01:32:48.922419 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m01:32:48.923203 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:48.923683 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m01:32:48.957312 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m01:32:48.958017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:48.959689 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
)

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m01:32:49.408210 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "races_drivers_results_joined" at [25:1]')
[0m01:32:49.609630 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:ad32b25b-3664-4495-a5b4-b2f1cda20edd&page=queryresults
[0m01:32:49.610347 [debug] [Thread-1 (]: finished collecting timing info
[0m01:32:49.611171 [debug] [Thread-1 (]: Database Error in model top_drivers (models/marts/top_drivers.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "races_drivers_results_joined" at [25:1]
  compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m01:32:49.611544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07b914f5-67a9-4519-af98-de301d14a428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb4550>]}
[0m01:32:49.611989 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model formula1.top_drivers ..................... [[31mERROR[0m in 0.69s]
[0m01:32:49.612473 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m01:32:49.613901 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:32:49.614564 [info ] [MainThread]: 
[0m01:32:49.614904 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m01:32:49.615223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:49.615401 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m01:32:49.629706 [info ] [MainThread]: 
[0m01:32:49.630089 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:32:49.630419 [info ] [MainThread]: 
[0m01:32:49.630770 [error] [MainThread]: [33mCompilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)[0m
[0m01:32:49.631175 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:32:49.631529 [info ] [MainThread]: 
[0m01:32:49.631809 [error] [MainThread]: [33mDatabase Error in model top_drivers (models/marts/top_drivers.sql)[0m
[0m01:32:49.632081 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "races_drivers_results_joined" at [25:1]
[0m01:32:49.632345 [error] [MainThread]:   compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m01:32:49.632616 [info ] [MainThread]: 
[0m01:32:49.632868 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m01:32:49.633218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b37d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b36440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b36080>]}
[0m01:32:49.633512 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:27:50.430542 | 2eed85b6-8f37-4c34-856d-4e0fb4656040 ==============================
[0m03:27:50.430624 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:27:50.431469 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:27:50.431778 [debug] [MainThread]: Tracking: tracking
[0m03:27:50.449984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3aa0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3aa230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3aa470>]}
[0m03:27:50.520422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:27:50.520813 [debug] [MainThread]: Partial parsing: updated file: formula1://models/marts/top_drivers.sql
[0m03:27:50.532417 [debug] [MainThread]: 1699: static parser successfully parsed marts/top_drivers.sql
[0m03:27:50.555463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:27:50.560088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c581ba0>]}
[0m03:27:50.567173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fbfa0>]}
[0m03:27:50.567495 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:27:50.567732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c525ea0>]}
[0m03:27:50.569175 [info ] [MainThread]: 
[0m03:27:50.569743 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:27:50.570809 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:27:50.571401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:51.086589 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:27:51.087041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:51.447667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c5b10>]}
[0m03:27:51.448554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:51.448907 [info ] [MainThread]: 
[0m03:27:51.452485 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:27:51.452836 [info ] [Thread-1 (]: 1 of 4 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m03:27:51.453564 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:27:51.453766 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:27:51.453956 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:27:51.457155 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:27:51.457838 [debug] [Thread-1 (]: finished collecting timing info
[0m03:27:51.458107 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:27:51.502971 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m03:27:51.503642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:51.505020 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m03:27:52.460647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:909085e8-4bd6-4aa7-a358-caa6e461fa45:us-east4&page=queryresults
[0m03:27:52.481430 [debug] [Thread-1 (]: finished collecting timing info
[0m03:27:52.482045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108805690>]}
[0m03:27:52.482424 [info ] [Thread-1 (]: 1 of 4 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m03:27:52.482893 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:27:52.483109 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:27:52.483451 [info ] [Thread-1 (]: 2 of 4 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m03:27:52.484076 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:27:52.484257 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:27:52.484424 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:27:52.487355 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:27:52.487937 [debug] [Thread-1 (]: finished collecting timing info
[0m03:27:52.488134 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:27:52.491508 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m03:27:52.492141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:52.493659 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m03:27:53.169571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:647f7a5e-0123-4a04-9655-9b0873c5c338:us-east4&page=queryresults
[0m03:27:53.172013 [debug] [Thread-1 (]: finished collecting timing info
[0m03:27:53.172734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c565870>]}
[0m03:27:53.173171 [info ] [Thread-1 (]: 2 of 4 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m03:27:53.173684 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:27:53.173956 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:27:53.174493 [info ] [Thread-1 (]: 3 of 4 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:27:53.175289 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:27:53.175508 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:27:53.175709 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:27:53.182003 [debug] [Thread-1 (]: finished collecting timing info
[0m03:27:53.184745 [debug] [Thread-1 (]: Compilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:27:53.185044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c683460>]}
[0m03:27:53.185409 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model formula1.stg_formula1__results ............ [[31mERROR[0m in 0.01s]
[0m03:27:53.185832 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:27:53.186060 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:27:53.186436 [info ] [Thread-1 (]: 4 of 4 START sql table model formula1.top_drivers .............................. [RUN]
[0m03:27:53.187091 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:27:53.187271 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:27:53.187439 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:27:53.191024 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:27:53.191654 [debug] [Thread-1 (]: finished collecting timing info
[0m03:27:53.191879 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:27:53.224739 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m03:27:53.225474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:53.226973 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m03:27:53.933339 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name driverId not found inside results at [28:35]')
[0m03:27:55.262714 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:877cc4c2-b2cc-463c-8635-7ff89e8ab8cf&page=queryresults
[0m03:27:55.263433 [debug] [Thread-1 (]: finished collecting timing info
[0m03:27:55.264246 [debug] [Thread-1 (]: Database Error in model top_drivers (models/marts/top_drivers.sql)
  Name driverId not found inside results at [28:35]
  compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:27:55.264621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eed85b6-8f37-4c34-856d-4e0fb4656040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6ef2b0>]}
[0m03:27:55.265046 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model formula1.top_drivers ..................... [[31mERROR[0m in 2.08s]
[0m03:27:55.265523 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:27:55.267015 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:27:55.267697 [info ] [MainThread]: 
[0m03:27:55.268051 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m03:27:55.268359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:55.268515 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:27:55.279475 [info ] [MainThread]: 
[0m03:27:55.279848 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:27:55.280166 [info ] [MainThread]: 
[0m03:27:55.280430 [error] [MainThread]: [33mCompilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)[0m
[0m03:27:55.280686 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:27:55.280932 [info ] [MainThread]: 
[0m03:27:55.281176 [error] [MainThread]: [33mDatabase Error in model top_drivers (models/marts/top_drivers.sql)[0m
[0m03:27:55.281417 [error] [MainThread]:   Name driverId not found inside results at [28:35]
[0m03:27:55.281674 [error] [MainThread]:   compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:27:55.281930 [info ] [MainThread]: 
[0m03:27:55.282183 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m03:27:55.282544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087adb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c653b20>]}
[0m03:27:55.282845 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:31:09.282483 | f01ce70e-bf40-4428-b83e-347befd1d024 ==============================
[0m03:31:09.282571 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:31:09.283072 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:31:09.283324 [debug] [MainThread]: Tracking: tracking
[0m03:31:09.301723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd088b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0a6e0>]}
[0m03:31:09.371176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:31:09.371357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:31:09.371729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:31:09.377139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bef1360>]}
[0m03:31:09.385447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be11f60>]}
[0m03:31:09.385785 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:31:09.386040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be11fc0>]}
[0m03:31:09.387778 [info ] [MainThread]: 
[0m03:31:09.388520 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:31:09.389646 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:31:09.389965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:31:09.884180 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:31:09.884601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:31:10.212410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2db70>]}
[0m03:31:10.213265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:31:10.213615 [info ] [MainThread]: 
[0m03:31:10.217140 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:31:10.217482 [info ] [Thread-1 (]: 1 of 4 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m03:31:10.218176 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:31:10.218373 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:31:10.218566 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:31:10.228090 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:31:10.228744 [debug] [Thread-1 (]: finished collecting timing info
[0m03:31:10.228956 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:31:10.271432 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m03:31:10.272156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:31:10.273565 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m03:31:11.066318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:f1758466-919e-440a-9bb8-08db9f944be8:us-east4&page=queryresults
[0m03:31:11.086555 [debug] [Thread-1 (]: finished collecting timing info
[0m03:31:11.087158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be10c40>]}
[0m03:31:11.087530 [info ] [Thread-1 (]: 1 of 4 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m03:31:11.087970 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:31:11.088190 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:31:11.088436 [info ] [Thread-1 (]: 2 of 4 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m03:31:11.089090 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:31:11.089378 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:31:11.089576 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:31:11.092550 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:31:11.093084 [debug] [Thread-1 (]: finished collecting timing info
[0m03:31:11.093275 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:31:11.096529 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m03:31:11.097019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:31:11.098322 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m03:31:12.051107 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:597ca870-4bb8-4904-bb15-0488bd8047ca:us-east4&page=queryresults
[0m03:31:12.053730 [debug] [Thread-1 (]: finished collecting timing info
[0m03:31:12.054455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfdeaa0>]}
[0m03:31:12.054889 [info ] [Thread-1 (]: 2 of 4 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m03:31:12.055393 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:31:12.055654 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:31:12.056055 [info ] [Thread-1 (]: 3 of 4 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:31:12.056867 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:31:12.057059 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:31:12.057301 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:31:12.060939 [debug] [Thread-1 (]: finished collecting timing info
[0m03:31:12.061520 [debug] [Thread-1 (]: Compilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:31:12.061793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c014ca0>]}
[0m03:31:12.062146 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model formula1.stg_formula1__results ............ [[31mERROR[0m in 0.01s]
[0m03:31:12.062560 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:31:12.062779 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:31:12.063172 [info ] [Thread-1 (]: 4 of 4 START sql table model formula1.top_drivers .............................. [RUN]
[0m03:31:12.063845 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:31:12.064031 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:31:12.064199 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:31:12.067802 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:31:12.068308 [debug] [Thread-1 (]: finished collecting timing info
[0m03:31:12.068496 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:31:12.178679 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m03:31:12.179340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:31:12.180680 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m03:31:13.159547 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name driverId not found inside results at [28:35]')
[0m03:31:13.655574 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:14583439-146c-4fce-9ca8-f77636f9c2bf&page=queryresults
[0m03:31:13.656278 [debug] [Thread-1 (]: finished collecting timing info
[0m03:31:13.657101 [debug] [Thread-1 (]: Database Error in model top_drivers (models/marts/top_drivers.sql)
  Name driverId not found inside results at [28:35]
  compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:31:13.657481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01ce70e-bf40-4428-b83e-347befd1d024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be118d0>]}
[0m03:31:13.657913 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model formula1.top_drivers ..................... [[31mERROR[0m in 1.59s]
[0m03:31:13.658398 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:31:13.659836 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:31:13.660509 [info ] [MainThread]: 
[0m03:31:13.660855 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m03:31:13.661161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:31:13.661318 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:31:13.670824 [info ] [MainThread]: 
[0m03:31:13.671184 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:31:13.671496 [info ] [MainThread]: 
[0m03:31:13.671756 [error] [MainThread]: [33mCompilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)[0m
[0m03:31:13.672012 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:31:13.672257 [info ] [MainThread]: 
[0m03:31:13.672502 [error] [MainThread]: [33mDatabase Error in model top_drivers (models/marts/top_drivers.sql)[0m
[0m03:31:13.672747 [error] [MainThread]:   Name driverId not found inside results at [28:35]
[0m03:31:13.672983 [error] [MainThread]:   compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:31:13.673240 [info ] [MainThread]: 
[0m03:31:13.673496 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m03:31:13.673853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7654b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a766740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be10340>]}
[0m03:31:13.674150 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:35:04.074337 | 4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a ==============================
[0m03:35:04.074362 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:35:04.075066 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:35:04.075376 [debug] [MainThread]: Tracking: tracking
[0m03:35:04.095638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec002b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec02f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec02e90>]}
[0m03:35:04.171694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:35:04.172135 [debug] [MainThread]: Partial parsing: updated file: formula1://models/staging/stg_formula1__results.sql
[0m03:35:04.184393 [debug] [MainThread]: 1603: static parser failed on staging/stg_formula1__results.sql
[0m03:35:04.196043 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_formula1__results.sql
[0m03:35:04.209142 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:35:04.213719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee1c160>]}
[0m03:35:04.220717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed66920>]}
[0m03:35:04.221008 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:35:04.221233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed817e0>]}
[0m03:35:04.222734 [info ] [MainThread]: 
[0m03:35:04.223376 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:35:04.224578 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:35:04.224929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:35:04.736140 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:35:04.736554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:35:05.136856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5db40>]}
[0m03:35:05.137726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:35:05.138081 [info ] [MainThread]: 
[0m03:35:05.141677 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:35:05.142026 [info ] [Thread-1 (]: 1 of 4 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m03:35:05.142741 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:35:05.142936 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:35:05.143128 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:35:05.146351 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:35:05.146959 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:05.147179 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:35:05.273188 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m03:35:05.273852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:05.275209 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m03:35:06.167872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:010f5f02-2b5a-4656-9ee9-b64a0dbb29cc:us-east4&page=queryresults
[0m03:35:06.188540 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:06.189148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed97f70>]}
[0m03:35:06.189521 [info ] [Thread-1 (]: 1 of 4 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m03:35:06.189962 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:35:06.190183 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:35:06.190520 [info ] [Thread-1 (]: 2 of 4 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m03:35:06.191148 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:35:06.191326 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:35:06.191491 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:35:06.194370 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:35:06.194872 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:06.195054 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:35:06.198155 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m03:35:06.198616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:06.199913 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m03:35:06.838080 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:f4fd68a9-82ca-4dcb-8f5a-50f829b253db:us-east4&page=queryresults
[0m03:35:06.840446 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:06.841136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed663b0>]}
[0m03:35:06.841560 [info ] [Thread-1 (]: 2 of 4 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 0.65s]
[0m03:35:06.842051 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:35:06.842316 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:35:06.842810 [info ] [Thread-1 (]: 3 of 4 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:35:06.843503 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:35:06.843756 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:35:06.843949 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:35:06.847815 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:06.848448 [debug] [Thread-1 (]: Compilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:35:06.848728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef05720>]}
[0m03:35:06.849115 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model formula1.stg_formula1__results ............ [[31mERROR[0m in 0.01s]
[0m03:35:06.849541 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:35:06.849766 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:35:06.850025 [info ] [Thread-1 (]: 4 of 4 START sql table model formula1.top_drivers .............................. [RUN]
[0m03:35:06.850806 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:35:06.851000 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:35:06.851177 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:35:06.855024 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:35:06.855662 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:06.855880 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:35:06.890836 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m03:35:06.891531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:06.892884 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m03:35:07.606832 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name driverId not found inside results at [28:35]')
[0m03:35:08.181031 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:e8969429-ccf0-4c1b-b5d8-f8b81cf2d526&page=queryresults
[0m03:35:08.181762 [debug] [Thread-1 (]: finished collecting timing info
[0m03:35:08.182585 [debug] [Thread-1 (]: Database Error in model top_drivers (models/marts/top_drivers.sql)
  Name driverId not found inside results at [28:35]
  compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:35:08.182970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b8817f2-acd9-4bf0-99fc-78eb6ff7f21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef19120>]}
[0m03:35:08.183392 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model formula1.top_drivers ..................... [[31mERROR[0m in 1.33s]
[0m03:35:08.183871 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:35:08.185339 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:35:08.186005 [info ] [MainThread]: 
[0m03:35:08.186353 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m03:35:08.186699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:35:08.186854 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:35:08.200353 [info ] [MainThread]: 
[0m03:35:08.200730 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:35:08.201064 [info ] [MainThread]: 
[0m03:35:08.201348 [error] [MainThread]: [33mCompilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)[0m
[0m03:35:08.201616 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:35:08.201871 [info ] [MainThread]: 
[0m03:35:08.202128 [error] [MainThread]: [33mDatabase Error in model top_drivers (models/marts/top_drivers.sql)[0m
[0m03:35:08.202379 [error] [MainThread]:   Name driverId not found inside results at [28:35]
[0m03:35:08.202617 [error] [MainThread]:   compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:35:08.202922 [info ] [MainThread]: 
[0m03:35:08.203313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m03:35:08.203787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef18a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef18580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef19e40>]}
[0m03:35:08.204194 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:40:09.827936 | a0731b24-1c6e-41a2-b0cc-8e0d65113df5 ==============================
[0m03:40:09.827983 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:40:09.828613 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_formula1__results.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:40:09.828875 [debug] [MainThread]: Tracking: tracking
[0m03:40:09.848635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ee0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ee230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ee470>]}
[0m03:40:09.912297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:40:09.912662 [debug] [MainThread]: Partial parsing: updated file: formula1://models/staging/stg_formula1__results.sql
[0m03:40:09.923699 [debug] [MainThread]: 1603: static parser failed on staging/stg_formula1__results.sql
[0m03:40:09.935021 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_formula1__results.sql
[0m03:40:09.947407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:40:09.951850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0731b24-1c6e-41a2-b0cc-8e0d65113df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143cd180>]}
[0m03:40:09.960697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0731b24-1c6e-41a2-b0cc-8e0d65113df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114143850>]}
[0m03:40:09.961112 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:40:09.961387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0731b24-1c6e-41a2-b0cc-8e0d65113df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114365c30>]}
[0m03:40:09.962852 [info ] [MainThread]: 
[0m03:40:09.963580 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:40:09.964431 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:40:09.964678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:40:10.449105 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:40:10.449569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:40:10.840469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0731b24-1c6e-41a2-b0cc-8e0d65113df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11221db10>]}
[0m03:40:10.841363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:40:10.841719 [info ] [MainThread]: 
[0m03:40:10.845101 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:40:10.845631 [info ] [Thread-1 (]: 1 of 1 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:40:10.846333 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:40:10.846531 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:40:10.846723 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:40:10.850465 [debug] [Thread-1 (]: finished collecting timing info
[0m03:40:10.851138 [debug] [Thread-1 (]: Compilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:40:10.851441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0731b24-1c6e-41a2-b0cc-8e0d65113df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143f3370>]}
[0m03:40:10.851850 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model formula1.stg_formula1__results ............ [[31mERROR[0m in 0.01s]
[0m03:40:10.852414 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:40:10.854111 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:40:10.854781 [info ] [MainThread]: 
[0m03:40:10.855107 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m03:40:10.855393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:40:10.855550 [debug] [MainThread]: Connection 'model.formula1.stg_formula1__results' was properly closed.
[0m03:40:10.947306 [info ] [MainThread]: 
[0m03:40:10.947714 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:40:10.948081 [info ] [MainThread]: 
[0m03:40:10.948403 [error] [MainThread]: [33mCompilation Error in model stg_formula1__results (models/staging/stg_formula1__results.sql)[0m
[0m03:40:10.948714 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:40:10.949029 [info ] [MainThread]: 
[0m03:40:10.949337 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:40:10.949745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141147f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b2aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110579690>]}
[0m03:40:10.950076 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:41:11.559591 | ecc7c4c5-49fc-4af8-89b3-9605b85c9817 ==============================
[0m03:41:11.559627 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:41:11.560134 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_formula1__results.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:41:11.560354 [debug] [MainThread]: Tracking: tracking
[0m03:41:11.579516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a38670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3a500>]}
[0m03:41:11.653785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:41:11.654335 [debug] [MainThread]: Partial parsing: updated file: formula1://models/staging/stg_formula1__results.sql
[0m03:41:11.668504 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_formula1__results.sql
[0m03:41:11.690708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:41:11.695193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc7c4c5-49fc-4af8-89b3-9605b85c9817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c09ab0>]}
[0m03:41:11.702954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc7c4c5-49fc-4af8-89b3-9605b85c9817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b9b160>]}
[0m03:41:11.703262 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:41:11.703492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc7c4c5-49fc-4af8-89b3-9605b85c9817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bb1cc0>]}
[0m03:41:11.704767 [info ] [MainThread]: 
[0m03:41:11.705333 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:41:11.706183 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:41:11.706452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:12.179749 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:41:12.180166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:12.576591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc7c4c5-49fc-4af8-89b3-9605b85c9817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea6db10>]}
[0m03:41:12.577518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:12.577879 [info ] [MainThread]: 
[0m03:41:12.581288 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:41:12.581836 [info ] [Thread-1 (]: 1 of 1 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:41:12.582550 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:41:12.582754 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:41:12.582952 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:41:12.586224 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__results"
[0m03:41:12.586877 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:12.587092 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__results
[0m03:41:12.631799 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__results"
[0m03:41:12.632552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:12.633937 [debug] [Thread-1 (]: On model.formula1.stg_formula1__results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__results"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__results`
  OPTIONS()
  as with

source_results as (
    select * from `armin-playground`.`formula1`.`results`
),

stg_results as (
    select driverId, raceId, grid, position, points, laps, time, fastestLapTime, fastestLapSpeed, fastestLap from source_results
)

select * from stg_results;


[0m03:41:13.524305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:57f332d6-635e-481f-b1f1-a6416d8ca327:us-east4&page=queryresults
[0m03:41:13.542941 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:13.543610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc7c4c5-49fc-4af8-89b3-9605b85c9817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfdf010>]}
[0m03:41:13.544013 [info ] [Thread-1 (]: 1 of 1 OK created sql view model formula1.stg_formula1__results ................ [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m03:41:13.544471 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:41:13.545840 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:41:13.546455 [info ] [MainThread]: 
[0m03:41:13.546770 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m03:41:13.547050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:13.547207 [debug] [MainThread]: Connection 'model.formula1.stg_formula1__results' was properly closed.
[0m03:41:13.556811 [info ] [MainThread]: 
[0m03:41:13.557191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:41:13.557524 [info ] [MainThread]: 
[0m03:41:13.557798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:41:13.558169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bed8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bc7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b9a980>]}
[0m03:41:13.558453 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:41:22.024963 | 0372ff8e-b223-43b6-bd87-93c7d3f89db5 ==============================
[0m03:41:22.024989 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:41:22.025566 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:41:22.025852 [debug] [MainThread]: Tracking: tracking
[0m03:41:22.044733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df248b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df264a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df266e0>]}
[0m03:41:22.114486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:41:22.114683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:41:22.115088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:41:22.120286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1012d0>]}
[0m03:41:22.129676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e029f00>]}
[0m03:41:22.130069 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:41:22.130393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e029f30>]}
[0m03:41:22.132626 [info ] [MainThread]: 
[0m03:41:22.133628 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:41:22.134969 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:41:22.135271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:22.623933 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:41:22.624384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:41:22.981705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf55b10>]}
[0m03:41:22.982621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:41:22.982979 [info ] [MainThread]: 
[0m03:41:22.986411 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:41:22.986717 [info ] [Thread-1 (]: 1 of 4 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m03:41:22.987415 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:41:22.987611 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:41:22.987802 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:41:22.996083 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:41:22.996766 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:22.997016 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:41:23.041482 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m03:41:23.042198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:23.043575 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m03:41:23.663877 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:991f4820-7dcb-4786-890a-4349633b2fe7:us-east4&page=queryresults
[0m03:41:23.683467 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:23.684075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e029bd0>]}
[0m03:41:23.684457 [info ] [Thread-1 (]: 1 of 4 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m03:41:23.684899 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:41:23.685118 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:41:23.685476 [info ] [Thread-1 (]: 2 of 4 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m03:41:23.686094 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:41:23.686270 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:41:23.686437 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:41:23.689441 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:41:23.689993 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:23.690186 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:41:23.693739 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m03:41:23.694527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:23.696046 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m03:41:24.702108 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:1d6ae9f0-7890-4f78-a8a8-071a2b288885:us-east4&page=queryresults
[0m03:41:24.704633 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:24.705368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e101a80>]}
[0m03:41:24.705786 [info ] [Thread-1 (]: 2 of 4 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m03:41:24.706275 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:41:24.706531 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:41:24.707063 [info ] [Thread-1 (]: 3 of 4 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:41:24.707767 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:41:24.707965 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:41:24.708153 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:41:24.711486 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__results"
[0m03:41:24.712164 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:24.712389 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__results
[0m03:41:24.716233 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__results"
[0m03:41:24.717071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:24.718642 [debug] [Thread-1 (]: On model.formula1.stg_formula1__results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__results"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__results`
  OPTIONS()
  as with

source_results as (
    select * from `armin-playground`.`formula1`.`results`
),

stg_results as (
    select driverId, raceId, grid, position, points, laps, time, fastestLapTime, fastestLapSpeed, fastestLap from source_results
)

select * from stg_results;


[0m03:41:25.434676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:27bc88ae-7938-430c-8ef2-eb441aa93fff:us-east4&page=queryresults
[0m03:41:25.437054 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:25.437756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1ff580>]}
[0m03:41:25.438180 [info ] [Thread-1 (]: 3 of 4 OK created sql view model formula1.stg_formula1__results ................ [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m03:41:25.438683 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:41:25.438946 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:41:25.439321 [info ] [Thread-1 (]: 4 of 4 START sql table model formula1.top_drivers .............................. [RUN]
[0m03:41:25.440139 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:41:25.440354 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:41:25.440556 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:41:25.451778 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:41:25.452293 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:25.452488 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:41:25.569603 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m03:41:25.570266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:25.571604 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, results.time, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m03:41:26.340272 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name driverId not found inside results at [28:35]')
[0m03:41:27.508645 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:ea8fd0bf-4ebd-4c42-9a89-c5115dfec6df&page=queryresults
[0m03:41:27.509364 [debug] [Thread-1 (]: finished collecting timing info
[0m03:41:27.510179 [debug] [Thread-1 (]: Database Error in model top_drivers (models/marts/top_drivers.sql)
  Name driverId not found inside results at [28:35]
  compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:41:27.510582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0372ff8e-b223-43b6-bd87-93c7d3f89db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e19f0d0>]}
[0m03:41:27.511010 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model formula1.top_drivers ..................... [[31mERROR[0m in 2.07s]
[0m03:41:27.511488 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:41:27.512872 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:41:27.513523 [info ] [MainThread]: 
[0m03:41:27.513866 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m03:41:27.514208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:27.514376 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:41:27.523607 [info ] [MainThread]: 
[0m03:41:27.523999 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:41:27.524333 [info ] [MainThread]: 
[0m03:41:27.524612 [error] [MainThread]: [33mDatabase Error in model top_drivers (models/marts/top_drivers.sql)[0m
[0m03:41:27.525034 [error] [MainThread]:   Name driverId not found inside results at [28:35]
[0m03:41:27.525461 [error] [MainThread]:   compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:41:27.525768 [info ] [MainThread]: 
[0m03:41:27.526049 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m03:41:27.526412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df384c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df38130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e19ff40>]}
[0m03:41:27.526728 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:45:55.687790 | a733a13d-960f-482b-b332-640ed5fdaf43 ==============================
[0m03:45:55.687844 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:45:55.688578 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:45:55.688856 [debug] [MainThread]: Tracking: tracking
[0m03:45:55.706903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e12f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e12410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e13d30>]}
[0m03:45:55.764722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:45:55.765110 [debug] [MainThread]: Partial parsing: updated file: formula1://models/marts/top_drivers.sql
[0m03:45:55.775763 [debug] [MainThread]: 1699: static parser successfully parsed marts/top_drivers.sql
[0m03:45:55.797546 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:45:55.802056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109131e70>]}
[0m03:45:55.810433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090da140>]}
[0m03:45:55.810749 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:45:55.810978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090da170>]}
[0m03:45:55.812328 [info ] [MainThread]: 
[0m03:45:55.813038 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:45:55.813956 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:45:55.814207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:45:56.333433 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:45:56.333852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:45:56.734990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6db40>]}
[0m03:45:56.735886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:45:56.736243 [info ] [MainThread]: 
[0m03:45:56.739708 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:45:56.740033 [info ] [Thread-1 (]: 1 of 4 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m03:45:56.740696 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:45:56.740883 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:45:56.741070 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:45:56.744001 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:45:56.744533 [debug] [Thread-1 (]: finished collecting timing info
[0m03:45:56.744712 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:45:56.784742 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m03:45:56.785349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:56.786555 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m03:45:57.762926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:e03a447d-3339-4f22-b784-b68de355614b:us-east4&page=queryresults
[0m03:45:57.780533 [debug] [Thread-1 (]: finished collecting timing info
[0m03:45:57.780979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1a800>]}
[0m03:45:57.781252 [info ] [Thread-1 (]: 1 of 4 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m03:45:57.781582 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:45:57.781744 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:45:57.782039 [info ] [Thread-1 (]: 2 of 4 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m03:45:57.782503 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:45:57.782637 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:45:57.782761 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:45:57.785034 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:45:57.785451 [debug] [Thread-1 (]: finished collecting timing info
[0m03:45:57.785586 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:45:57.789164 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m03:45:57.789879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:57.791175 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m03:45:58.734465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:291a287f-4b74-4ac0-a8a6-525cf227bee8:us-east4&page=queryresults
[0m03:45:58.736886 [debug] [Thread-1 (]: finished collecting timing info
[0m03:45:58.737631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917abc0>]}
[0m03:45:58.738049 [info ] [Thread-1 (]: 2 of 4 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m03:45:58.738545 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:45:58.738804 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:45:58.739181 [info ] [Thread-1 (]: 3 of 4 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:45:58.739850 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:45:58.740022 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:45:58.740182 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:45:58.745159 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__results"
[0m03:45:58.745682 [debug] [Thread-1 (]: finished collecting timing info
[0m03:45:58.745856 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__results
[0m03:45:58.750461 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__results"
[0m03:45:58.751063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:58.752169 [debug] [Thread-1 (]: On model.formula1.stg_formula1__results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__results"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__results`
  OPTIONS()
  as with

source_results as (
    select * from `armin-playground`.`formula1`.`results`
),

stg_results as (
    select driverId, raceId, grid, position, points, laps, time, fastestLapTime, fastestLapSpeed, fastestLap from source_results
)

select * from stg_results;


[0m03:45:59.447918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:c13a7cc1-58f9-4d48-8a14-69f37aa1652a:us-east4&page=queryresults
[0m03:45:59.450478 [debug] [Thread-1 (]: finished collecting timing info
[0m03:45:59.451168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914b550>]}
[0m03:45:59.451583 [info ] [Thread-1 (]: 3 of 4 OK created sql view model formula1.stg_formula1__results ................ [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m03:45:59.452075 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:45:59.452709 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:45:59.453020 [info ] [Thread-1 (]: 4 of 4 START sql table model formula1.top_drivers .............................. [RUN]
[0m03:45:59.453629 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:45:59.453798 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:45:59.453957 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:45:59.457358 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:45:59.457857 [debug] [Thread-1 (]: finished collecting timing info
[0m03:45:59.458030 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:45:59.484763 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m03:45:59.485414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:45:59.486446 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__results`
),

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, cleartime, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m03:46:00.354175 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: cleartime at [26:80]')
[0m03:46:00.822673 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:us-east4:88abcb5e-54a4-4528-b8ed-4de101817dba&page=queryresults
[0m03:46:00.823355 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:00.824172 [debug] [Thread-1 (]: Database Error in model top_drivers (models/marts/top_drivers.sql)
  Unrecognized name: cleartime at [26:80]
  compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:46:00.824561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a733a13d-960f-482b-b332-640ed5fdaf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927ca00>]}
[0m03:46:00.824993 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model formula1.top_drivers ..................... [[31mERROR[0m in 1.37s]
[0m03:46:00.825482 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:46:00.826950 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:46:00.827617 [info ] [MainThread]: 
[0m03:46:00.827958 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m03:46:00.828251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:00.828397 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:46:00.838107 [info ] [MainThread]: 
[0m03:46:00.838362 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:46:00.838574 [info ] [MainThread]: 
[0m03:46:00.838755 [error] [MainThread]: [33mDatabase Error in model top_drivers (models/marts/top_drivers.sql)[0m
[0m03:46:00.838969 [error] [MainThread]:   Unrecognized name: cleartime at [26:80]
[0m03:46:00.839219 [error] [MainThread]:   compiled Code at target/run/formula1/models/marts/top_drivers.sql
[0m03:46:00.839478 [info ] [MainThread]: 
[0m03:46:00.839734 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m03:46:00.840055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ebe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927c760>]}
[0m03:46:00.840363 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:46:19.456578 | c4dec55b-261f-4fa1-b24c-4473655225fe ==============================
[0m03:46:19.456668 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:46:19.457149 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:46:19.457394 [debug] [MainThread]: Tracking: tracking
[0m03:46:19.477075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccca0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccca230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccca470>]}
[0m03:46:19.534485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:46:19.534861 [debug] [MainThread]: Partial parsing: updated file: formula1://models/marts/top_drivers.sql
[0m03:46:19.546107 [debug] [MainThread]: 1699: static parser successfully parsed marts/top_drivers.sql
[0m03:46:19.567460 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:46:19.571906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca1ba0>]}
[0m03:46:19.580670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc1ff70>]}
[0m03:46:19.580973 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:46:19.581195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc49ea0>]}
[0m03:46:19.582479 [info ] [MainThread]: 
[0m03:46:19.583120 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:46:19.584078 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground"
[0m03:46:19.584299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:20.092375 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:46:20.092796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:20.461023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b949ae0>]}
[0m03:46:20.461895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:46:20.462257 [info ] [MainThread]: 
[0m03:46:20.465734 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:46:20.466064 [info ] [Thread-1 (]: 1 of 4 START sql view model formula1.stg_formula1__drivers ..................... [RUN]
[0m03:46:20.466722 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:46:20.466909 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:46:20.467087 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:46:20.470110 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:46:20.470695 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:20.470896 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:46:20.506940 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__drivers"
[0m03:46:20.507523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:20.508594 [debug] [Thread-1 (]: On model.formula1.stg_formula1__drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__drivers"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__drivers`
  OPTIONS()
  as with

source_drivers as (
    select * from `armin-playground`.`formula1`.`drivers`
), 

stg_drivers as (
    select driverId, forename, surname from source_drivers
)

select * from stg_drivers;


[0m03:46:21.453357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:354d4bc5-53bb-4c65-ae57-bf587ab5d636:us-east4&page=queryresults
[0m03:46:21.471023 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:21.471471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc5fbe0>]}
[0m03:46:21.471750 [info ] [Thread-1 (]: 1 of 4 OK created sql view model formula1.stg_formula1__drivers ................ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m03:46:21.472078 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:46:21.472242 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:46:21.472540 [info ] [Thread-1 (]: 2 of 4 START sql view model formula1.stg_formula1__races ....................... [RUN]
[0m03:46:21.473002 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:46:21.473133 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:46:21.473257 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:46:21.475498 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:46:21.475929 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:21.476070 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:46:21.479527 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__races"
[0m03:46:21.480033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:21.481159 [debug] [Thread-1 (]: On model.formula1.stg_formula1__races: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__races"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__races`
  OPTIONS()
  as with

source_races as (
    select * from `armin-playground`.`formula1`.`races`
),

stg_races as(
    select raceId, year, name, round from source_races
)

select * from stg_races;


[0m03:46:22.102450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:eea0823d-9cb0-4e39-9f48-d6023f437055:us-east4&page=queryresults
[0m03:46:22.104942 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:22.105704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce3340>]}
[0m03:46:22.106154 [info ] [Thread-1 (]: 2 of 4 OK created sql view model formula1.stg_formula1__races .................. [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m03:46:22.106679 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:46:22.106950 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:46:22.107320 [info ] [Thread-1 (]: 3 of 4 START sql view model formula1.stg_formula1__results ..................... [RUN]
[0m03:46:22.108022 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:46:22.108209 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:46:22.108375 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:46:22.113431 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__results"
[0m03:46:22.113933 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:22.114095 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__results
[0m03:46:22.118091 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.stg_formula1__results"
[0m03:46:22.118437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:22.119417 [debug] [Thread-1 (]: On model.formula1.stg_formula1__results: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.stg_formula1__results"} */


  create or replace view `armin-playground`.`formula1`.`stg_formula1__results`
  OPTIONS()
  as with

source_results as (
    select * from `armin-playground`.`formula1`.`results`
),

stg_results as (
    select driverId, raceId, grid, position, points, laps, time, fastestLapTime, fastestLapSpeed, fastestLap from source_results
)

select * from stg_results;


[0m03:46:22.775845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:0fbd10de-7c90-4679-9bc9-ab97529b834e:us-east4&page=queryresults
[0m03:46:22.778512 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:22.779222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcab370>]}
[0m03:46:22.779649 [info ] [Thread-1 (]: 3 of 4 OK created sql view model formula1.stg_formula1__results ................ [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m03:46:22.780153 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:46:22.780760 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:46:22.781082 [info ] [Thread-1 (]: 4 of 4 START sql table model formula1.top_drivers .............................. [RUN]
[0m03:46:22.781699 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:46:22.781873 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:46:22.782036 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:46:22.785437 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:46:22.785981 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:22.786186 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:46:22.812490 [debug] [Thread-1 (]: Writing runtime sql for node "model.formula1.top_drivers"
[0m03:46:22.813035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:22.814042 [debug] [Thread-1 (]: On model.formula1.top_drivers: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "node_id": "model.formula1.top_drivers"} */

  
    

    create or replace table `armin-playground`.`formula1`.`top_drivers`
    
    
    OPTIONS()
    as (
      with

races as (
    select * from `armin-playground`.`formula1`.`stg_formula1__races`
),

drivers as (
    select * from `armin-playground`.`formula1`.`stg_formula1__drivers`
),

results as (
    select * from `armin-playground`.`formula1`.`stg_formula1__results`
),

races_drivers_results_joined as (
    select year, name, round, surname, forename, grid, position, points, laps, time, fastestLapTime, fastestLapSpeed, fastestLap
    from results
    inner join drivers on results.driverId = drivers.driverId
    inner join races on results.raceId = races.raceId
    where position = 1
    order by year DESC, round ASC
)

select * from races_drivers_results_joined
    );
  
[0m03:46:25.284807 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:5c9399de-ab3b-4aa7-b4cc-44f914dc00b6:us-east4&page=queryresults
[0m03:46:25.286886 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:25.287588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dec55b-261f-4fa1-b24c-4473655225fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddf2d40>]}
[0m03:46:25.288019 [info ] [Thread-1 (]: 4 of 4 OK created sql table model formula1.top_drivers ......................... [[32mCREATE TABLE (1.1k rows, 1.4 MB processed)[0m in 2.51s]
[0m03:46:25.288533 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:46:25.289979 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:46:25.290614 [info ] [MainThread]: 
[0m03:46:25.290894 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m03:46:25.291156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:25.291301 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:46:25.301176 [info ] [MainThread]: 
[0m03:46:25.301436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:46:25.301661 [info ] [MainThread]: 
[0m03:46:25.301882 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:46:25.302293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc5fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc5ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddf26e0>]}
[0m03:46:25.302555 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 03:47:38.312761 | be2e7f75-6a89-4aa9-8094-c0e52b46590a ==============================
[0m03:47:38.312783 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:47:38.313445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m03:47:38.313652 [debug] [MainThread]: Tracking: tracking
[0m03:47:38.331802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127304f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127322f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112733010>]}
[0m03:47:38.402606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:47:38.402796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:47:38.403181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:47:38.408666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be2e7f75-6a89-4aa9-8094-c0e52b46590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112914a00>]}
[0m03:47:38.417473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be2e7f75-6a89-4aa9-8094-c0e52b46590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128dd630>]}
[0m03:47:38.417810 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:47:38.418078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be2e7f75-6a89-4aa9-8094-c0e52b46590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128dd660>]}
[0m03:47:38.419782 [info ] [MainThread]: 
[0m03:47:38.420506 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:47:38.421651 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:47:38.422004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:38.831912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be2e7f75-6a89-4aa9-8094-c0e52b46590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126c9690>]}
[0m03:47:38.832868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:47:38.833231 [info ] [MainThread]: 
[0m03:47:38.836870 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:47:38.837476 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:47:38.837680 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:47:38.837878 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:47:38.844925 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:47:38.845654 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.845951 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:47:38.846187 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.847009 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:47:38.847301 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:47:38.847951 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:47:38.848155 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:47:38.848332 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:47:38.853260 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:47:38.853889 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.854109 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:47:38.854294 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.854966 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:47:38.855199 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:47:38.855790 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:47:38.855993 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:47:38.856170 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:47:38.859620 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__results"
[0m03:47:38.860267 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.860510 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__results
[0m03:47:38.860725 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.861415 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:47:38.861903 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:47:38.862671 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:47:38.862959 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:47:38.863149 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:47:38.867040 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:47:38.867667 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.867894 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:47:38.868077 [debug] [Thread-1 (]: finished collecting timing info
[0m03:47:38.868711 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:47:38.869619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:47:38.869802 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:47:38.878265 [info ] [MainThread]: Done.
[0m03:47:38.880334 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m03:47:38.880566 [info ] [MainThread]: Building catalog
[0m03:47:38.882411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:47:39.380461 [debug] [ThreadPool]: Acquiring new bigquery connection "armin-playground.information_schema"
[0m03:47:39.399038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:47:39.400452 [debug] [ThreadPool]: On armin-playground.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "connection_name": "armin-playground.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `armin-playground`.`formula1`.__TABLES__
        where (upper(dataset_id) = upper('formula1'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m03:47:41.688411 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:376cb22f-78b9-4558-a710-3e25e5818ef0:us-east4&page=queryresults
[0m03:47:41.764339 [info ] [MainThread]: Catalog written to /Users/arminefendic/Documents/dbt_projects/formula1/target/catalog.json
[0m03:47:41.764798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b9270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b92a0>]}
[0m03:47:41.765220 [debug] [MainThread]: Flushing usage events
[0m03:47:41.941603 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m03:47:41.941926 [debug] [MainThread]: Connection 'armin-playground.information_schema' was properly closed.


============================== 2023-01-02 03:47:49.090612 | 6fc95f7d-d661-4a11-9360-2ee582d97168 ==============================
[0m03:47:49.090668 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:47:49.091429 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m03:47:49.091683 [debug] [MainThread]: Tracking: tracking
[0m03:47:49.110154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a6680>]}
[0m03:47:49.114330 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m03:47:49.114805 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m03:47:49.115071 [info ] [MainThread]: 
[0m03:47:49.115307 [info ] [MainThread]: 
[0m03:47:49.115548 [info ] [MainThread]: Press Ctrl+C to exit.
[0m03:50:34.902031 [debug] [MainThread]: Flushing usage events
[0m03:50:35.126589 [info ] [MainThread]: ctrl-c


============================== 2023-01-02 03:50:44.673618 | c409ed8f-6f5a-4bcf-8e45-b5b9b4f5b7a0 ==============================
[0m03:50:44.673738 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:50:44.674391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m03:50:44.674619 [debug] [MainThread]: Tracking: tracking
[0m03:50:44.693932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ba0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ba260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ba4a0>]}
[0m03:50:44.770770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:50:44.771508 [debug] [MainThread]: Partial parsing: update schema file: formula1://models/schema.yml
[0m03:50:44.797447 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.formula1.intermediate

[0m03:50:44.804593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c409ed8f-6f5a-4bcf-8e45-b5b9b4f5b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c3eb0>]}
[0m03:50:44.816318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c409ed8f-6f5a-4bcf-8e45-b5b9b4f5b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b64bf10>]}
[0m03:50:44.816766 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
[0m03:50:44.817074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c409ed8f-6f5a-4bcf-8e45-b5b9b4f5b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61e680>]}
[0m03:50:44.818867 [info ] [MainThread]: 
[0m03:50:44.819623 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m03:50:44.820805 [debug] [ThreadPool]: Acquiring new bigquery connection "list_armin-playground_formula1"
[0m03:50:44.821097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:50:45.264932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c409ed8f-6f5a-4bcf-8e45-b5b9b4f5b7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b64bbe0>]}
[0m03:50:45.265843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:50:45.266200 [info ] [MainThread]: 
[0m03:50:45.269815 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__drivers
[0m03:50:45.270408 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__drivers"
[0m03:50:45.270604 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__drivers
[0m03:50:45.270795 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__drivers
[0m03:50:45.274102 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__drivers"
[0m03:50:45.274696 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.274899 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__drivers
[0m03:50:45.275092 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.275771 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__drivers
[0m03:50:45.276087 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__races
[0m03:50:45.276846 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__races"
[0m03:50:45.277100 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__races
[0m03:50:45.277322 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__races
[0m03:50:45.281567 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__races"
[0m03:50:45.282257 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.282519 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__races
[0m03:50:45.282723 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.283575 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__races
[0m03:50:45.283867 [debug] [Thread-1 (]: Began running node model.formula1.stg_formula1__results
[0m03:50:45.284595 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.stg_formula1__results"
[0m03:50:45.285152 [debug] [Thread-1 (]: Began compiling node model.formula1.stg_formula1__results
[0m03:50:45.285534 [debug] [Thread-1 (]: Compiling model.formula1.stg_formula1__results
[0m03:50:45.289070 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.stg_formula1__results"
[0m03:50:45.289674 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.289890 [debug] [Thread-1 (]: Began executing node model.formula1.stg_formula1__results
[0m03:50:45.290070 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.290736 [debug] [Thread-1 (]: Finished running node model.formula1.stg_formula1__results
[0m03:50:45.291237 [debug] [Thread-1 (]: Began running node model.formula1.top_drivers
[0m03:50:45.292089 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.formula1.top_drivers"
[0m03:50:45.292298 [debug] [Thread-1 (]: Began compiling node model.formula1.top_drivers
[0m03:50:45.292475 [debug] [Thread-1 (]: Compiling model.formula1.top_drivers
[0m03:50:45.300281 [debug] [Thread-1 (]: Writing injected SQL for node "model.formula1.top_drivers"
[0m03:50:45.300924 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.301160 [debug] [Thread-1 (]: Began executing node model.formula1.top_drivers
[0m03:50:45.301365 [debug] [Thread-1 (]: finished collecting timing info
[0m03:50:45.302482 [debug] [Thread-1 (]: Finished running node model.formula1.top_drivers
[0m03:50:45.303820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:50:45.304084 [debug] [MainThread]: Connection 'model.formula1.top_drivers' was properly closed.
[0m03:50:45.381626 [info ] [MainThread]: Done.
[0m03:50:45.383713 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m03:50:45.383922 [info ] [MainThread]: Building catalog
[0m03:50:45.385958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:50:45.978917 [debug] [ThreadPool]: Acquiring new bigquery connection "armin-playground.information_schema"
[0m03:50:45.995223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:50:45.996447 [debug] [ThreadPool]: On armin-playground.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "formula1", "target_name": "dev", "connection_name": "armin-playground.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `armin-playground`.`formula1`.__TABLES__
        where (upper(dataset_id) = upper('formula1'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `armin-playground`.`formula1`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m03:50:48.003480 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=armin-playground&j=bq:c42bfecd-4fa5-4245-bcd4-e19e5ba44416:us-east4&page=queryresults
[0m03:50:48.077981 [info ] [MainThread]: Catalog written to /Users/arminefendic/Documents/dbt_projects/formula1/target/catalog.json
[0m03:50:48.078351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ba0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b751840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b753f70>]}
[0m03:50:48.078554 [debug] [MainThread]: Flushing usage events
[0m03:50:48.240540 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m03:50:48.240869 [debug] [MainThread]: Connection 'armin-playground.information_schema' was properly closed.


============================== 2023-01-02 03:50:56.445591 | 9d50670e-c425-40b7-aaf8-dcba15faa190 ==============================
[0m03:50:56.445615 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:50:56.446219 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m03:50:56.446486 [debug] [MainThread]: Tracking: tracking
[0m03:50:56.465348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c6740>]}
[0m03:50:56.469611 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m03:50:56.470106 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m03:50:56.470391 [info ] [MainThread]: 
[0m03:50:56.470637 [info ] [MainThread]: 
[0m03:50:56.470880 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2023-01-02 22:35:11.415103 | e03fb66b-c1c8-4342-839d-91e1cad8646a ==============================
[0m22:35:11.415112 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:35:11.415876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/arminefendic/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m22:35:11.415992 [debug] [MainThread]: Tracking: tracking
[0m22:35:11.433922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5de40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d94a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d94fd0>]}
[0m22:35:11.436588 [info ] [MainThread]: Setting up your profile.
[0m22:35:18.563016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5fe20>]}
[0m22:35:18.563485 [debug] [MainThread]: Flushing usage events
